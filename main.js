!function(){"use strict";const e=document.querySelector(".profile__image"),t=document.querySelector(".popup_type_profile"),s=document.querySelector(".profile__button"),n=(t.querySelector(".popup__close"),t.querySelector(".popup__input_type_name")),i=t.querySelector(".popup__input_type_profession"),r=document.querySelector(".add-button");function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}document.querySelector(".elements__cards"),document.querySelector(".popup__form_edit"),document.querySelector(".popup__form_cards"),document.querySelector(".popup__form_avatar");class a{constructor(e,t){o(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,errorClass:n}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(n),i.textContent=t,i.classList.add(s)})),o(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,n=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(s),n.classList.remove(t),n.textContent=""})),o(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),o(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.inputList=Array.from(this._formElement.querySelectorAll(e)),this._toggleButton(),this.inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),o(this,"_hasValidInput",(()=>this.inputList.every((e=>e.validity.valid)))),o(this,"_toggleButton",(()=>{const{inactiveButtonClass:e}=this._settings;this._inactiveButtonClass=e,this._hasValidInput()?this.enableButton():this.disableButton()})),o(this,"enableButton",(()=>{this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass)})),o(this,"disableButton",(()=>{this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass)})),this._settings=e,this._formElement=t,this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}resetValidation(){this.inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class l{constructor(e,t,s,n,i,r){this._data=e,this._name=e.name,this._link=e.link,this._likes=e.likes,this._id=e._id,this._userId=t,this._ownerId=e.owner._id,this._templateCardSelector=s,this._handleCardClick=n,this._handleLikeIcon=i,this._handleDeleteClick=r}getId(){return this._id}_getTemplate(){return document.querySelector(this._templateCardSelector).content.querySelector(".elements__card")}_addEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeIcon())),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}removeCard(){this._cardElement.remove(),this._cardElement=null}setLikeCounter(e){this._likes=e;const t=this._likes.length;this._cardLikeCounter.textContent=t,this.isLiked()?this._likeButton.classList.add("elements__button-like_active"):this._likeButton.classList.remove("elements__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}generateCard(){return this._cardElement=this._getTemplate().cloneNode(!0),this._cardImage=this._cardElement.querySelector(".elements__image"),this._cardName=this._cardElement.querySelector(".elements__card-text"),this._likeButton=this._cardElement.querySelector(".elements__button-like"),this._deleteButton=this._cardElement.querySelector(".elements__button-delete"),this._cardLikeCounter=this._cardElement.querySelector(".elements__card_likes"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName.textContent=this._name,this._addEventListeners(),this.setLikeCounter(this._likes),this._userId!==this._ownerId&&(this._deleteButton.style.display="none"),this._cardElement}}const h="popup_open";class c{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add(h),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove(h),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}}class d extends c{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=this._form.querySelectorAll(".popup__input"),this._submitButton=this._popup.querySelector(".popup__save")}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.id,n=t.value;e[s]=n})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitForm(this._getInputValues())}))}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}changeSubmitHandler(e){this._handleSubmitForm=e}changeText(e){const t=this._submitButton;"Saving"===e&&(t.textContent="Saving..."),"Default"===e&&(t.textContent="Save")}close(){super.close(),this._form.reset()}}function _(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const u=new class{constructor(e){_(this,"editProfile",((e,t)=>fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse).then((e=>e.json())))),_(this,"addLike",(e=>fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._checkResponse).then((e=>e.json())))),_(this,"removeLike",(e=>fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse).then((e=>e.json())))),this._baseUrl=e.baseUrl,this._headers=e.headers,this._checkResponse=e.checkResponse}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse).then((e=>e.json()))}getInitialCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse).then((e=>e.json()))}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}_checkResponse(e){return e.ok?e.json():Promise.reject(e.statusText)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"9398a483-484e-4ebd-a374-b6b3b985e9c4","Content-Type":"application/json"}});let p;Promise.all([u.getUserInfo(),u.getInitialCards()]).then((e=>{let[t,s]=e;p=t._id,L.setUserInfo(t.name,t.about,t.avatar),S.rendererItems(s)})).catch(console.log);const m={};var f;f={inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input-error_open",errorClass:"popup__error_visible",formSelector:".popup__form"},Array.from(document.querySelectorAll(f.formSelector)).forEach((e=>{const t=new a(f,e),s=e.getAttribute("name");m[s]=t,t.enableValidation(),t.resetValidation(),t.disableButton(),t.enableButton()}));const v=e=>{E.open(),E.changeSubmitHandler((()=>{u.deleteCard(e.getId()).then((()=>{e.removeCard()})),E.close()}))},g=new d("#popup-template",(e=>{g.changeText("Saving"),u.editProfile(e.name,e.profession).then((t=>{L.setUserInfo(t.name,e.profession,t.avatar)})).then((e=>{g.close(e)})).catch(console.log).finally((()=>{m.profileForm.resetValidation(),m.profileForm.enableButton(),g.changeText("Default")}))}));g.setEventListeners();const b=new d("#popup-template-avatar",(e=>{b.changeText("Saving"),u.editAvatar(e.link).then((e=>{L.setUserInfo(e.name,e.about,e.avatar),b.changeText("Default")})).then((e=>{b.close(e)})).catch(console.log).finally((()=>{m.avatarChange.resetValidation(),m.avatarChange.disableButton()}))}));b.setEventListeners();const k=new d("#popup-template-form",(e=>{k.changeText("Saving"),u.addCard(e.cardTitle,e.cardImageLink).then((e=>{S.addItem(e)})).then((e=>{k.close(e)})).catch(console.log).finally((()=>{m["add-cards"].resetValidation(),m["add-cards"].disableButton(),k.changeText("Default")}))}));k.setEventListeners();const E=new d("#popup-template-confirm",v);E.setEventListeners();const y=new class extends c{constructor(e){super(e),this._subtitle=this._popup.querySelector(".popup__subtitle"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._subtitle.textContent=e}}("#popup-image");y.setEventListeners();const S=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}rendererItems(e){e.forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}({renderer:e=>{const t=new l(e,p,"#card-template",(()=>(e=>{y.open(e.name,e.link)})(e)),(()=>{var e;((e=t).isLiked()?u.removeLike:u.addLike)(e.getId()).then((t=>{e.setLikeCounter(t.likes)}))}),(e=>v(e)));return t.generateCard()}},".elements__cards"),L=new class{constructor(e){let{profileNameSelector:t,profileProfessionSelector:s,profileAvatar:n}=e;this._profileName=document.querySelector(t),this._profileProfession=document.querySelector(s),this._profileAvatar=document.querySelector(n)}getUserInfo(){return{name:this._profileName.textContent,profession:this._profileProfession.textContent,avatar:this._profileAvatar.style.backgroundImage}}setUserInfo(e,t,s){this._profileName.textContent=e,this._profileProfession.textContent=t,this._profileAvatar.style.backgroundImage="url(".concat(s,")")}}({profileNameSelector:".profile__header",profileProfessionSelector:".profile__profession",profileAvatar:".profile__image"});s.addEventListener("click",(function(){const e=L.getUserInfo();n.value=e.name,i.value=e.profession,g.open()})),r.addEventListener("click",(()=>{k.open()})),e.addEventListener("click",(()=>{b.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S3VMLGFBQWFoTCxZQUN4QjBKLFdBQVlqSyxLQUFLd0wsbUJBQW1CakwsWUFDcEM2SCxPQUFRcEksS0FBS3lMLGVBQWV4RyxNQUFNeUcsaUJBSXRDekMsWUFBWW5HLEVBQU1tSCxFQUFZN0IsR0FDNUJwSSxLQUFLdUwsYUFBYWhMLFlBQWN1QyxFQUNoQzlDLEtBQUt3TCxtQkFBbUJqTCxZQUFjMEosRUFDdENqSyxLQUFLeUwsZUFBZXhHLE1BQU15RyxnQkFBMUIsY0FBbUR0RCxFQUFuRCxPSCtJMEIsQ0FDNUJpRCxvQkFBcUIsbUJBQ3JCQywwQkFBMkIsdUJBQzNCdE0sY0FBZSxvQkFhakJJLEVBQVdpQyxpQkFBaUIsU0FWNUIsV0FDRSxNQUFNc0ssRUFBYzNDLEVBQVNkLGNBRTdCN0ksRUFBVW1ILE1BQVFtRixFQUFZN0ksS0FDOUJ4RCxFQUFnQmtILE1BQVFtRixFQUFZMUIsV0FFcENGLEVBQWlCcEUsVUFNbkJwRyxFQUFVOEIsaUJBQWlCLFNBQVMsS0FDbEMrSSxFQUFhekUsVUFHZjNHLEVBQWNxQyxpQkFBaUIsU0FBUyxLQUN0QzhJLEVBQWtCeEUsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vRm9yIFByb2ZpbGUgYW5kIHBvcHVwIGVsZW1lbnRzXG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcblxuY29uc3QgcHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIik7IC8vLnBvcHVwIGJhc3Rha2kgc2lsaW5kaVxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uXCIpO1xuY29uc3QgY2xvc2VCdXR0b24gPSBwcm9maWxlUG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XG5jb25zdCBpbnB1dE5hbWUgPSBwcm9maWxlUG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdHlwZV9uYW1lXCIpO1xuY29uc3QgaW5wdXRQcm9mZXNzaW9uID0gcHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfcHJvZmVzc2lvblwiKTtcblxuLy8gLy8vLy9DQVJEU1xuXG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1idXR0b25cIik7XG5cbi8vIFdyYXBwZXJzXG5jb25zdCBlbGVtZW50c0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19jYXJkc1wiKTtcblxuY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3NhdmVcIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZV9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX29wZW5cIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCJcbn07XG5cbmNvbnN0IGVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9lZGl0XCIpO1xuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX2NhcmRzXCIpO1xuY29uc3QgYXZhdGFyQ2hhbmdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9hdmF0YXJcIik7XG5cblxuZXhwb3J0IHtcbiAgc2V0dGluZ3MsIGVkaXRGb3JtLCBhZGRDYXJkRm9ybSwgYXZhdGFyQ2hhbmdlLCBlZGl0QnV0dG9uLCBjbG9zZUJ1dHRvbiwgaW5wdXROYW1lLCBpbnB1dFByb2Zlc3Npb24sXG4gIGFkZEJ1dHRvbiwgZWxlbWVudHNMaXN0LCBwcm9maWxlQXZhdGFyXG59O1xuXG5cblxuLy9jb25zdCBwcm9maWxlSW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mb1wiKTtcbi8vIGNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZUluZm8ucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19oZWFkZXJcIik7XG4vLyBjb25zdCBwcm9maWxlUHJvZmVzc2lvbiA9IHByb2ZpbGVJbmZvLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcHJvZmVzc2lvblwiKTtcbi8vIGNvbnN0IHBvcHVwTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIik7XG4vLyBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zLnByb2ZpbGVGb3JtOyAvL3F1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9mb3JtJyk7Ly9cbi8vIGNvbnN0IHBvcHVwU2VsZWN0b3IgPSBcInBvcHVwX29wZW5cIjtcblxuXG4vLyBjb25zdCBDYXJkX1RlbXBsYXRlX1NlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiO1xuLy8gY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlLXByZXZpZXdcIik7XG4vLyBjb25zdCBjYXJkRGVsZXRlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfY29uZmlybS1kZWxldGVcIik7XG4vLyBjb25zdCBkZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b25fZGVsZXRlXCIpXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0LCBlcnJvck1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG5cbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcblxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXQpID0+IHtcbiAgICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCwgaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XG4gICAgfVxuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuX3NldHRpbmdzO1xuXG4gICAgdGhpcy5pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChpbnB1dFNlbGVjdG9yKVxuICAgICk7XG5cbiAgICB0aGlzLl90b2dnbGVCdXR0b24oKTsgLy9tZXRob2QgY2hlY2tcblxuICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9oYXNWYWxpZElucHV0ID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLmlucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfTtcblxuICBfdG9nZ2xlQnV0dG9uID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGluYWN0aXZlQnV0dG9uQ2xhc3M7XG5cbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLmVuYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gIH07XG5cbiAgZW5hYmxlQnV0dG9uID0gKCkgPT4ge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9O1xuXG4gIGRpc2FibGVCdXR0b24gPSAoKSA9PiB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfTtcblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuXG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHVzZXJJZCwgdGVtcGxhdGVDYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUljb24sIGhhbmRsZURlbGV0ZUNsaWNrKSB7XG4gICAgLy9jb25zb2xlLmxvZyhcImRhdGFcIiwgZGF0YSk7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgLy9jb25zb2xlLmxvZyhcIm93bmVySWRcIiwgZGF0YS5vd25lci5faWQpXG5cbiAgICB0aGlzLl90ZW1wbGF0ZUNhcmRTZWxlY3RvciA9IHRlbXBsYXRlQ2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gIH1cblxuICBnZXRJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faWRcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZUNhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fY2FyZCcpO1xuICB9XG5cbiAgX2FkZEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlSWNvbigpKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKSk7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspKTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoKXtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBzZXRMaWtlQ291bnRlcihuZXdMaWtlcykgeyAgIC8vbGVuZ3RoIGvEsXNtxLFuxLEgb2t1eWFtxLF5b3Iga2FydCBla2xlbmVtaXlvciAtIGhhbmRsZWNhcmRzdWJtaXQgZm9ua3NpeW9udW5hIGxpa2VzIHZlIF9pZCBla2xleWVyZWsgw6fDtnpkw7wgXl4rK1xuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG5cbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9jYXJkTGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSBsaWtlQ291bnRlcjtcblxuICAgIGNvbnN0IGxpa2VDbGlja2VkYnlDdXJyZW50VXNlciA9IHRoaXMuaXNMaWtlZCgpO1xuICAgIGlmKGxpa2VDbGlja2VkYnlDdXJyZW50VXNlcikge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdlbGVtZW50c19fYnV0dG9uLWxpa2VfYWN0aXZlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnZWxlbWVudHNfX2J1dHRvbi1saWtlX2FjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIGlzTGlrZWQoKXtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuZmluZCh1c2VyID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICB9XG5cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19faW1hZ2UnKTtcbiAgICB0aGlzLl9jYXJkTmFtZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fY2FyZC10ZXh0Jyk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fYnV0dG9uLWxpa2UnKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2J1dHRvbi1kZWxldGUnKTtcbiAgICB0aGlzLl9jYXJkTGlrZUNvdW50ZXIgPSAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19jYXJkX2xpa2VzJyk7XG5cbiAgICAvL2NhcmQgLy8gZGVzdHJ1Y3R1cmluZyBhc3NpZ25tZW50Ly9cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkTmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuc2V0TGlrZUNvdW50ZXIodGhpcy5fbGlrZXMpO1xuXG4gICAgaWYodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJyAvLyBlbGVtZW50c19fYnV0dG9uLWRlbGV0ZVxuICAgICAgfTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuXG4iLCJjb25zdCBQT1BVUF9DTEFTUyA9ICdwb3B1cCc7XG5jb25zdCBDTE9TRV9CVVRUT05fQ0xBU1MgPSAncG9wdXBfX2Nsb3NlJztcbmNvbnN0IFBPUFVQX1NFTEVDVE9SX0NMQVNTID0gJ3BvcHVwX29wZW4nO1xuXG5leHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpXG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoUE9QVVBfU0VMRUNUT1JfQ0xBU1MpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFBPUFVQX1NFTEVDVE9SX0NMQVNTKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFBPUFVQX0NMQVNTKSB8fFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhDTE9TRV9CVVRUT05fQ0xBU1MpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pXG4gIH1cbn1cbi8vKioqIG1vdXNlZG93biByZXBsYWNlZCBjbGljayB0byBwcmV2ZW50IHRoZSBidWcgaWYgeW91IGNsaWNrIGluc2lkZSBhIHBvcHVwIGFuZCB0aGVuIG1vdmUgeW91ciBtb3VzZSBvdXRzaWRlIGl0XG4vLyBhbmQgcmVsZWFzZSB0aGUgYnV0dG9uIGFib3ZlIHRoZSBvdmVybGF5IHRoZW4gdGhlIHBvcHVwIGNsb3NlcyBidXQgaXTigJlzIG5vdFxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0Rm9ybSApIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxuXG4gICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSA9IGhhbmRsZVN1Ym1pdEZvcm1cbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJylcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKVxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZScpXG4gICAgLy8gdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQudGV4dENvbnRlbnRcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCB2YWx1ZXMgPSB7fVxuXG5cbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IGlucHV0LmlkXG4gICAgICBjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlXG4gICAgICB2YWx1ZXNba2V5XSA9IHZhbHVlXG4gICAgfSlcbiAgICByZXR1cm4gdmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpXG5cbiAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lciggJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgLy9jb25zb2xlLmxvZygnaW5wdXQgdGFrZW4nKVxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKVxuICAgICAgICB9KVxuICAgICAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpe1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pXG4gIH1cblxuICBjaGFuZ2VTdWJtaXRIYW5kbGVyKG5ld1N1Ym1pdEhhbmRsZXIpIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtID0gbmV3U3VibWl0SGFuZGxlclxuICB9XG5cbiAgY2hhbmdlVGV4dCh0ZXh0KSB7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5fc3VibWl0QnV0dG9uO1xuICAgIC8vIHRoaXMucmVuZGVyTG9hZGluZygpXG5cbiAgICBpZih0ZXh0ID09PSAnU2F2aW5nJykge1xuICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ1NhdmluZy4uLidcbiAgICB9XG4gICAgaWYodGV4dCA9PT0gJ0RlZmF1bHQnKSB7XG4gICAgICBidXR0b24udGV4dENvbnRlbnQgPSAnU2F2ZSdcbiAgICB9XG4gIH1cblxuXG4gIC8vIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dD0nU2F2aW5nLi4uJykge1xuICAvLyAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuX3N1Ym1pdEJ1dHRvbjtcbiAgLy8gICBpZiAoaXNMb2FkaW5nKSB7XG4gIC8vICAgICB0aGlzLmJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICB0aGlzLmJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbjtcbiAgLy8gICB9XG4gIC8vIH1cblxuICBjbG9zZSgpIHtcbiAgICAgIHN1cGVyLmNsb3NlKClcbiAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKVxuICB9XG5cbn1cblxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmxcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzXG4gICAgdGhpcy5fY2hlY2tSZXNwb25zZSA9IG9wdGlvbnMuY2hlY2tSZXNwb25zZVxuICB9XG5cblxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy91c2Vycy9tZScsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgLy8gLmNhdGNoKGVyciA9PiB7XG4gICAgLy8gICBjb25zb2xlLmxvZygnQXBpIGhhcyBhbiBlcnJvciEhIScpXG4gICAgLy8gfSlcbiAgfVxuXG4gIGVkaXRQcm9maWxlID0gKG5hbWUsIGFib3V0KSA9PiB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL3VzZXJzL21lJywge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICB9XG5cbiAgZWRpdEF2YXRhcihhdmF0YXIpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUvYXZhdGFyJywge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXJcbiAgICAgIH0pXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcycsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gIH0gLy9uYW1lICAmIGxpbmsgaW4gdGhlIGJvZHkgY2hlY2sgbS5cblxuICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMnLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICB9XG5cbiAgYWRkTGlrZSA9IChpZCkgPT4ge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcy9saWtlcy8nICsgaWQsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gIH1cblxuICByZW1vdmVMaWtlID0gKGlkKSA9PiB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL2NhcmRzL2xpa2VzLycgKyBpZCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvJyArIGlkLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKXtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpO1xuICAgIH1cbiAgfVxufVxuXG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjkzOThhNDgzLTQ4NGUtNGViZC1hMzc0LWI2YjNiOTg1ZTljNFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gIH1cbn0pOyAvLyB0aGlzLl9iYXNlVXJsIC8vIHRoaXMuX2hlYWRlcnNcbiIsIlxuaW1wb3J0IFwiLi4vcGFnZS9pbmRleC5jc3NcIjsgLy8gbWFpbiBicmlkZ2UgdG8gY3NzIGZpbGVzIGFmdGVyIHdlYnBhY2sgYnVpbGQgYWx3YXlzIGluc3RhbGwgMXN0XG5cbmltcG9ydCB7IHNldHRpbmdzLCBlZGl0Rm9ybSwgYWRkQ2FyZEZvcm0sIGVkaXRCdXR0b24sIGlucHV0TmFtZSwgaW5wdXRQcm9mZXNzaW9uLFxuICAgICAgICAgYWRkQnV0dG9uLCBwcm9maWxlQXZhdGFyLCBhdmF0YXJDaGFuZ2UgfSBmcm9tICcuLi91dGlscy9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9ICBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuXG5pbXBvcnQgeyBhcGksIEFwaSB9IGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbi8vaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xuXG5sZXQgdXNlcklkXG5cbi8vYXBpLmdldFVzZXJJbmZvICYgYXBpLmdldEluaXRpYWxDYXJkcyBjb21iaW5lZCB3aXRoIFByb21pc2UuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZCAvL2NvbnNvbGUubG9nKCd1c2VyID0+JywgdXNlckRhdGEpXG5cbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCAgdXNlckRhdGEuYWJvdXQsIHVzZXJEYXRhLmF2YXRhcilcbiAgICBzZWN0aW9uLnJlbmRlcmVySXRlbXMoY2FyZHMpXG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmxvZylcblxuXG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge31cblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoIGNvbmZpZywgZm9ybUVsZW1lbnQgKVxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJylcblxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcblxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gICAgdmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIHZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gICAgdmFsaWRhdG9yLmVuYWJsZUJ1dHRvbigpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuXG5cbmNvbnN0IGhhbmRsZUNhcmRTdWJtaXQgPSAoZGF0YSkgPT4ge1xuICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dCgnU2F2aW5nJylcbiAgYXBpLmFkZENhcmQoZGF0YS5jYXJkVGl0bGUsIGRhdGEuY2FyZEltYWdlTGluaylcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKHJlcylcbiAgICB9KVxuICAgIC50aGVuKCByZXMgPT4ge1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKHJlcyk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkgKCgpID0+IHtcbiAgICAgIGZvcm1WYWxpZGF0b3JzWydhZGQtY2FyZHMnXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgICAgIGZvcm1WYWxpZGF0b3JzWydhZGQtY2FyZHMnXS5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dCgnRGVmYXVsdCcpO1xuICAgIH0pXG5cblxufVxuLy9oYW5kbGUgZWRpdHByb2ZpbGUgc3VibWl0XG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dCgnU2F2aW5nJylcbiAgYXBpLmVkaXRQcm9maWxlKGRhdGEubmFtZSwgZGF0YS5wcm9mZXNzaW9uKVxuICAgIC50aGVuKCByZXMgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIGRhdGEucHJvZmVzc2lvbiwgcmVzLmF2YXRhcilcbiAgICB9KVxuICAgIC50aGVuKCByZXMgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZShyZXMpXG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZm9ybVZhbGlkYXRvcnNbJ3Byb2ZpbGVGb3JtJ10ucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgICBmb3JtVmFsaWRhdG9yc1sncHJvZmlsZUZvcm0nXS5lbmFibGVCdXR0b24oKTtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dCgnRGVmYXVsdCcpXG4gICAgfSlcbn07XG5cbi8vIGhhbmRsZSBhdmF0YXIgUGljdHVyZSBTdWJtaXRcbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gIGF2YXRhckNoYW5nZVBvcHVwLmNoYW5nZVRleHQoJ1NhdmluZycpXG4gIGFwaS5lZGl0QXZhdGFyKCBkYXRhLmxpbmspXG4gICAgLnRoZW4oIHJlcyA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0LCByZXMuYXZhdGFyKVxuICAgICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dCgnRGVmYXVsdCcpXG4gICAgfSlcbiAgICAudGhlbiggcmVzID0+IHtcbiAgICAgIGF2YXRhckNoYW5nZVBvcHVwLmNsb3NlKHJlcyk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkoICgpID0+IHtcbiAgICAgIGZvcm1WYWxpZGF0b3JzWydhdmF0YXJDaGFuZ2UnXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgICAgIGZvcm1WYWxpZGF0b3JzWydhdmF0YXJDaGFuZ2UnXS5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSlcbn07XG5cbi8vaGFuZGxlIENhcmQgQ2xpY2tcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChkYXRhKSA9PiB7XG4gIGltYWdlUG9wdXAub3BlbihkYXRhLm5hbWUsIGRhdGEubGluayk7XG59XG5cbi8vaGFuZGxlIENhcmQgTGlrZSBGdW5jdGlvblxuY29uc3QgaGFuZGxlTGlrZUljb24gPSAoY2FyZCkgPT4ge1xuICBjb25zdCByZXF1ZXN0ID0gY2FyZC5pc0xpa2VkKCkgPyBhcGkucmVtb3ZlTGlrZSA6IGFwaS5hZGRMaWtlXG5cbiAgcmVxdWVzdChjYXJkLmdldElkKCkpXG4gIC50aGVuIChyZXMgPT4gIHtcbiAgICAgIGNhcmQuc2V0TGlrZUNvdW50ZXIocmVzLmxpa2VzKVxuICB9KVxufVxuXG4vLyBoYW5kbGUgY29uZmlybSBDYXJkIERlbGV0ZSBGdW5jdGlvblxuY29uc3QgaGFuZGxlRGVsZXRlQ2xpY2sgPSAoY2FyZCkgPT4ge1xuICBjb25maXJtQ2FyZERlbGV0ZS5vcGVuKClcblxuICBjb25maXJtQ2FyZERlbGV0ZS5jaGFuZ2VTdWJtaXRIYW5kbGVyKCgpID0+IHtcbiAgICBhcGkuZGVsZXRlQ2FyZChjYXJkLmdldElkKCkpXG4gICAgLnRoZW4oICgpID0+IHtcbiAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpXG4gICAgfSlcbiAgICBjb25maXJtQ2FyZERlbGV0ZS5jbG9zZSgpXG4gIH0pXG59XG5cbi8vY2xhc3MgaW5zdGFuY2VzIG9mIFBvcHVwXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cC10ZW1wbGF0ZScsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KVxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGF2YXRhckNoYW5nZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cC10ZW1wbGF0ZS1hdmF0YXInLCBoYW5kbGVBdmF0YXJTdWJtaXQpXG5hdmF0YXJDaGFuZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcjcG9wdXAtdGVtcGxhdGUtZm9ybScsIGhhbmRsZUNhcmRTdWJtaXQpXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKSAvL29ubHkgY2FsbCBvbmNlXG5cbmNvbnN0IGNvbmZpcm1DYXJkRGVsZXRlID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cC10ZW1wbGF0ZS1jb25maXJtJywgaGFuZGxlRGVsZXRlQ2xpY2spXG5jb25maXJtQ2FyZERlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJyNwb3B1cC1pbWFnZScpXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IGl0ZW0gPSBuZXcgQ2FyZCAoXG4gICAgZGF0YSxcbiAgICB1c2VySWQsXG4gICAgJyNjYXJkLXRlbXBsYXRlJyxcbiAgICAoKSA9PiBoYW5kbGVDYXJkQ2xpY2soZGF0YSksICAgICAgLy80dGggY29uc3RydWN0b3IgaXRlbSBoYW5kbGVDYXJkQ2xpY2tcbiAgICAoKSA9PiBoYW5kbGVMaWtlSWNvbihpdGVtKSwgICAgICAgLy81dGggIGNvbnN0cnVjdG9yIGl0ZW0gaGFuZGxlTGlrZUljb25cbiAgICAoaWQpID0+IGhhbmRsZURlbGV0ZUNsaWNrKGlkKSAgICAgLy82dGggY29uc3RyY3V0b3IgaXRlbSBoYW5kbGVEZWxldGVDbGlja1xuICApXG4gcmV0dXJuIGl0ZW0uZ2VuZXJhdGVDYXJkKCk7XG59XG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbiggeyByZW5kZXJlcjogY3JlYXRlQ2FyZCB9LCAnLmVsZW1lbnRzX19jYXJkcycgKVxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHByb2ZpbGVOYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9faGVhZGVyJyxcbiAgcHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvcjogJy5wcm9maWxlX19wcm9mZXNzaW9uJyxcbiAgcHJvZmlsZUF2YXRhcjogJy5wcm9maWxlX19pbWFnZScsXG59KVxuXG5mdW5jdGlvbiBvcGVuUHJvZmlsZVBvcHVwKCkge1xuICBjb25zdCBwcm9maWxlSW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG5cbiAgaW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZUluZm8ubmFtZTtcbiAgaW5wdXRQcm9mZXNzaW9uLnZhbHVlID0gcHJvZmlsZUluZm8ucHJvZmVzc2lvbjtcblxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbn1cblxuLy9FdmVudCBoYW5kbGVycyBzdWJzY3JpcHRpb25zIHRvIHBvcHVwL21vZGFsIGNvbnRyb2xzXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblByb2ZpbGVQb3B1cClcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xufSlcblxucHJvZmlsZUF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgYXZhdGFyQ2hhbmdlUG9wdXAub3BlbigpO1xufSlcblxuXG4iLCJcbmltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3RvcilcbiAgICB0aGlzLl9zdWJ0aXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc3VidGl0bGUnKTtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbiAgfVxuXG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG5cbiAgICBzdXBlci5vcGVuKClcbiAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XG4gICAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgICAgdGhpcy5fc3VidGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuXG4gIH1cblxufVxuIiwiXG5leHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyICkge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xuICB9XG5cblxuXG4gIHJlbmRlcmVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuYWRkSXRlbShkYXRhKVxuICAgIH0pXG4gIH07XG5cbiAgYWRkSXRlbShkYXRhKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGRhdGEpXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcbiAgfTtcblxuXG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7cHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvciwgcHJvZmlsZUF2YXRhcn0pXG4gIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZT0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlUHJvZmVzc2lvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZVByb2Zlc3Npb25TZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhcj0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlQXZhdGFyKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgcHJvZmVzc2lvbjogdGhpcy5fcHJvZmlsZVByb2Zlc3Npb24udGV4dENvbnRlbnQsXG4gICAgICBhdmF0YXI6IHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlXG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgcHJvZmVzc2lvbiwgYXZhdGFyKSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3Byb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcHJvZmVzc2lvbjtcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHthdmF0YXJ9KWA7XG4gIH1cblxuXG59XG4iXSwibmFtZXMiOlsicHJvZmlsZUF2YXRhciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByb2ZpbGVQb3B1cCIsImVkaXRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dFByb2Zlc3Npb24iLCJhZGRCdXR0b24iLCJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiaW5wdXQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidGhpcyIsIl9zZXR0aW5ncyIsImVycm9yRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJyZW1vdmUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpbnB1dFNlbGVjdG9yIiwiaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl90b2dnbGVCdXR0b24iLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldmVyeSIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9oYXNWYWxpZElucHV0IiwiZW5hYmxlQnV0dG9uIiwiZGlzYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQ2FyZCIsImRhdGEiLCJ1c2VySWQiLCJ0ZW1wbGF0ZUNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VJY29uIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfZGF0YSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2lkIiwiX3VzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJfdGVtcGxhdGVDYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VJY29uIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiZ2V0SWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsInJlbW92ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJzZXRMaWtlQ291bnRlciIsIm5ld0xpa2VzIiwibGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJfY2FyZExpa2VDb3VudGVyIiwiaXNMaWtlZCIsImZpbmQiLCJ1c2VyIiwiZ2VuZXJhdGVDYXJkIiwiY2xvbmVOb2RlIiwiX2NhcmROYW1lIiwic3JjIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiUE9QVVBfU0VMRUNUT1JfQ0xBU1MiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Rm9ybSIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdEZvcm0iLCJfZm9ybSIsIl9pbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsImUiLCJzZXRJbnB1dFZhbHVlcyIsImNoYW5nZVN1Ym1pdEhhbmRsZXIiLCJuZXdTdWJtaXRIYW5kbGVyIiwiY2hhbmdlVGV4dCIsInRleHQiLCJidXR0b24iLCJyZXNldCIsImFwaSIsIm9wdGlvbnMiLCJhYm91dCIsImZldGNoIiwiX2Jhc2VVcmwiLCJtZXRob2QiLCJoZWFkZXJzIiwiX2hlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsImpzb24iLCJiYXNlVXJsIiwiY2hlY2tSZXNwb25zZSIsImdldFVzZXJJbmZvIiwiZWRpdEF2YXRhciIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJkZWxldGVDYXJkIiwib2siLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsImF1dGhvcml6YXRpb24iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNlY3Rpb24iLCJyZW5kZXJlckl0ZW1zIiwiY2F0Y2giLCJjb25zb2xlIiwibG9nIiwiZm9ybVZhbGlkYXRvcnMiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImNhcmQiLCJjb25maXJtQ2FyZERlbGV0ZSIsImVkaXRQcm9maWxlUG9wdXAiLCJlZGl0UHJvZmlsZSIsInByb2Zlc3Npb24iLCJmaW5hbGx5IiwiYXZhdGFyQ2hhbmdlUG9wdXAiLCJhZGRDYXJkUG9wdXAiLCJjYXJkVGl0bGUiLCJjYXJkSW1hZ2VMaW5rIiwiYWRkSXRlbSIsImltYWdlUG9wdXAiLCJfc3VidGl0bGUiLCJfaW1hZ2UiLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtcyIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaXRlbSIsInJlbW92ZUxpa2UiLCJhZGRMaWtlIiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVQcm9mZXNzaW9uU2VsZWN0b3IiLCJfcHJvZmlsZU5hbWUiLCJfcHJvZmlsZVByb2Zlc3Npb24iLCJfcHJvZmlsZUF2YXRhciIsImJhY2tncm91bmRJbWFnZSIsInByb2ZpbGVJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==