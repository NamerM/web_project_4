!function(){"use strict";const e=document.querySelector(".profile__image"),t=document.querySelector(".popup_type_profile"),s=document.querySelector(".profile__button"),n=(t.querySelector(".popup__close"),t.querySelector(".popup__input_type_name")),i=t.querySelector(".popup__input_type_profession"),r=document.querySelector(".add-button"),o=(document.querySelector(".elements__cards"),{inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input-error_open",errorClass:"popup__error_visible"}),a=document.querySelector(".popup__form_edit"),l=document.querySelector(".popup__form_cards"),h=document.querySelector(".popup__form_avatar");function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var _=class{constructor(e,t){c(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,errorClass:n}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(n),i.textContent=t,i.classList.add(s)})),c(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,n=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(s),n.classList.remove(t),n.textContent=""})),c(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),c(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.inputList=Array.from(this._formElement.querySelectorAll(e)),this._toggleButton(),this.inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),c(this,"_hasValidInput",(()=>this.inputList.every((e=>e.validity.valid)))),c(this,"_toggleButton",(()=>{const{inactiveButtonClass:e}=this._settings;this._inactiveButtonClass=e,this._hasValidInput()?this.enableButton():this.disableButton()})),c(this,"enableButton",(()=>{this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass)})),c(this,"disableButton",(()=>{this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass)})),this._settings=e,this._formElement=t,this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}resetValidation(){this.inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class d{constructor(e,t,s,n,i,r){this._data=e,this._name=e.name,this._link=e.link,this._likes=e.likes,this._id=e._id,this._userId=t,this._ownerId=e.owner._id,this._templateCardSelector=s,this._handleCardClick=n,this._handleLikeIcon=i,this._handleDeleteClick=r}getId(){return this._id}_getTemplate(){return document.querySelector(this._templateCardSelector).content.querySelector(".elements__card")}_addEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeIcon())),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}removeCard(){this._cardElement.remove(),this._cardElement=null}setLikeCounter(e){this._likes=e;const t=this._likes.length;this._cardLikeCounter.textContent=t,this.isLiked()?this._likeButton.classList.add("elements__button-like_active"):this._likeButton.classList.remove("elements__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}generateCard(){return this._cardElement=this._getTemplate().cloneNode(!0),this._cardImage=this._cardElement.querySelector(".elements__image"),this._cardName=this._cardElement.querySelector(".elements__card-text"),this._likeButton=this._cardElement.querySelector(".elements__button-like"),this._deleteButton=this._cardElement.querySelector(".elements__button-delete"),this._cardLikeCounter=this._cardElement.querySelector(".elements__card_likes"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName.textContent=this._name,this._addEventListeners(),this.setLikeCounter(this._likes),this._userId!==this._ownerId&&(this._deleteButton.style.display="none"),this._cardElement}}const u="popup_open";class p{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add(u),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove(u),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}}class m extends p{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=this._form.querySelectorAll(".popup__input"),this._submitButton=this._popup.querySelector(".popup__save")}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.id,n=t.value;e[s]=n})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitForm(this._getInputValues())}))}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}changeSubmitHandler(e){this._handleSubmitForm=e}changeText(e){const t=this._submitButton;"Saving"===e&&(t.textContent="Saving..."),"Default"===e&&(t.textContent="Save")}close(){super.close(),this._form.reset()}}const f=new class{constructor(e){var t,s;s=(e,t)=>fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse).then((e=>e.json())),(t="editProfile")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._baseUrl=e.baseUrl,this._headers=e.headers,this._checkResponse=e.checkResponse}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse).then((e=>e.json()))}getInitialCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse).then((e=>e.json()))}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse).then((e=>e.json()))}_checkResponse(e){return e.ok?e.json():Promise.reject(e.statusText)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"9398a483-484e-4ebd-a374-b6b3b985e9c4","Content-Type":"application/json"}});let v;Promise.all([f.getUserInfo(),f.getInitialCards()]).then((e=>{let[t,s]=e;v=t._id,B.setUserInfo(t.name,t.about,t.avatar),q.rendererItems(s)})).catch(console.log);const g=new _(o,a),b=new _(o,l),k=new _(o,h);g.enableValidation(),b.enableValidation(),k.enableValidation(),g.resetValidation();const E=e=>{C.open(),C.changeSubmitHandler((()=>{f.deleteCard(e.getId()).then((()=>{e.removeCard()})),C.close()}))},y=new m("#popup-template",(e=>{y.changeText("Saving"),f.editProfile(e.name,e.profession).then((t=>{B.setUserInfo(t.name,e.profession,t.avatar)})).then((e=>{y.close(e)})).catch(console.log).finally((()=>{y.changeText("Default")}))}));y.setEventListeners();const L=new m("#popup-template-avatar",(e=>{L.changeText("Saving"),f.editAvatar(e.link).then((e=>{B.setUserInfo(e.name,e.about,e.avatar),L.changeText("Default")})).catch(console.log).finally((()=>{L.close()}))}));L.setEventListeners();const S=new m("#popup-template-form",(e=>{S.changeText("Saving"),f.addCard(e.cardTitle,e.cardImageLink).then((e=>{q.addItem(e)})).then((e=>{S.close(e)})).catch(console.log).finally((()=>{S.changeText("Default")}))}));S.setEventListeners();const C=new m("#popup-template-confirm",E);C.setEventListeners();const I=new class extends p{constructor(e){super(e),this._subtitle=this._popup.querySelector(".popup__subtitle"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._subtitle.textContent=e}}("#popup-image");I.setEventListeners();const q=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}rendererItems(e){e.forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}({renderer:e=>{const t=new d(e,v,"#card-template",(()=>(e=>{I.open(e.name,e.link)})(e)),(()=>{var e;(e=t).isLiked()?f.removeLike(e.getId()).then((t=>{e.setLikeCounter(t.likes)})).catch(console.log):f.addLike(e.getId()).then((t=>{e.setLikeCounter(t.likes)})).catch(console.log)}),(e=>E(e)));return t.generateCard()}},".elements__cards"),B=new class{constructor(e){let{profileNameSelector:t,profileProfessionSelector:s,profileAvatar:n}=e;this._profileName=document.querySelector(t),this._profileProfession=document.querySelector(s),this._profileAvatar=document.querySelector(n)}getUserInfo(){return{name:this._profileName.textContent,profession:this._profileProfession.textContent,avatar:this._profileAvatar.style.backgroundImage}}setUserInfo(e,t,s){this._profileName.textContent=e,this._profileProfession.textContent=t,this._profileAvatar.style.backgroundImage="url(".concat(s,")")}}({profileNameSelector:".profile__header",profileProfessionSelector:".profile__profession",profileAvatar:".profile__image"});s.addEventListener("click",(function(){const e=B.getUserInfo();n.value=e.name,i.value=e.profession,g.resetValidation(),g.enableButton(),y.open()})),r.addEventListener("click",(()=>{b.resetValidation(),b.disableButton(),S.open()})),e.addEventListener("click",(()=>{k.resetValidation(),k.disableButton(),L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsTUFBTUEsRUFBZ0JDLFNBQVNDLGNBQWMsbUJBRXZDQyxFQUFlRixTQUFTQyxjQUFjLHVCQUN0Q0UsRUFBYUgsU0FBU0MsY0FBYyxvQkFFcENHLEdBRGNGLEVBQWFELGNBQWMsaUJBQzdCQyxFQUFhRCxjQUFjLDRCQUN2Q0ksRUFBa0JILEVBQWFELGNBQWMsaUNBSTdDSyxFQUFZTixTQUFTQyxjQUFjLGVBS25DTSxHQUZlUCxTQUFTQyxjQUFjLG9CQUUzQixDQUNmTyxjQUFlLGdCQUNmQyxxQkFBc0IsZUFDdEJDLG9CQUFxQix1QkFDckJDLGdCQUFpQiwwQkFDakJDLFdBQVkseUJBR1JDLEVBQVdiLFNBQVNDLGNBQWMscUJBQ2xDYSxFQUFjZCxTQUFTQyxjQUFjLHNCQUNyQ2MsRUFBZWYsU0FBU0MsY0FBYyx1Qix3SENrRTVDLE1BNUZBLE1BQ0VlLFlBQVlULEVBQVVVLEdBQWEsMEJBUWpCLENBQUNDLEVBQU9DLEtBQ3hCLE1BQU0sZ0JBQUVSLEVBQUYsV0FBbUJDLEdBQWVRLEtBQUtDLFVBRXZDQyxFQUFlRixLQUFLRyxhQUFhdEIsY0FBbEIsV0FBb0NpQixFQUFNTSxHQUExQyxXQUNyQk4sRUFBTU8sVUFBVUMsSUFBSWQsR0FDcEJVLEVBQWFLLFlBQWNSLEVBQzNCRyxFQUFhRyxVQUFVQyxJQUFJZixNQWRNLDBCQWlCaEJPLElBQ2pCLE1BQU0sZ0JBQUVQLEVBQUYsV0FBbUJDLEdBQWVRLEtBQUtDLFVBRXZDQyxFQUFlRixLQUFLRyxhQUFhdEIsY0FBbEIsV0FBb0NpQixFQUFNTSxHQUExQyxXQUNyQk4sRUFBTU8sVUFBVUcsT0FBT2hCLEdBQ3ZCVSxFQUFhRyxVQUFVRyxPQUFPakIsR0FDOUJXLEVBQWFLLFlBQWMsTUF2Qk0sOEJBMEJaVCxJQUNoQkEsRUFBTVcsU0FBU0MsTUFHbEJWLEtBQUtXLGdCQUFnQmIsR0FGckJFLEtBQUtZLGdCQUFnQmQsRUFBT0EsRUFBTWUsc0JBNUJILDZCQWtDZCxLQUNuQixNQUFNLGNBQUV6QixHQUFrQlksS0FBS0MsVUFFL0JELEtBQUtjLFVBQVlDLE1BQU1DLEtBQ3JCaEIsS0FBS0csYUFBYWMsaUJBQWlCN0IsSUFHckNZLEtBQUtrQixnQkFFTGxCLEtBQUtjLFVBQVVLLFNBQVNyQixJQUN0QkEsRUFBTXNCLGlCQUFpQixTQUFTLEtBQzlCcEIsS0FBS3FCLG9CQUFvQnZCLEdBQ3pCRSxLQUFLa0IseUJBOUN3Qix5QkFtRGxCLElBQ1JsQixLQUFLYyxVQUFVUSxPQUFPeEIsR0FBVUEsRUFBTVcsU0FBU0MsVUFwRHJCLHdCQXVEbkIsS0FDZCxNQUFNLG9CQUFFcEIsR0FBd0JVLEtBQUtDLFVBQ3JDRCxLQUFLdUIscUJBQXVCakMsRUFFeEJVLEtBQUt3QixpQkFDUHhCLEtBQUt5QixlQUVMekIsS0FBSzBCLG1CQTlEMEIsdUJBa0VwQixLQUNiMUIsS0FBSzJCLGNBQWNDLFVBQVcsRUFDOUI1QixLQUFLMkIsY0FBY3RCLFVBQVVHLE9BQU9SLEtBQUt1Qix5QkFwRVIsd0JBdUVuQixLQUNkdkIsS0FBSzJCLGNBQWNDLFVBQVcsRUFDOUI1QixLQUFLMkIsY0FBY3RCLFVBQVVDLElBQUlOLEtBQUt1Qix5QkF4RXRDdkIsS0FBS0MsVUFBWWQsRUFDakJhLEtBQUtHLGFBQWVOLEVBQ3BCRyxLQUFLMkIsY0FBZ0IzQixLQUFLRyxhQUFhdEIsY0FDckNtQixLQUFLQyxVQUFVWixzQkF3RW5Cd0Msa0JBQ0U3QixLQUFLYyxVQUFVSyxTQUFTckIsSUFDdEJFLEtBQUtXLGdCQUFnQmIsTUFJekJnQyxtQkFDRTlCLEtBQUtHLGFBQWFpQixpQkFBaUIsVUFBV1csSUFDNUNBLEVBQUlDLG9CQUdOaEMsS0FBS2lDLHVCQ3hGRixNQUFNQyxFQUNYdEMsWUFBWXVDLEVBQU1DLEVBQVFDLEVBQXNCQyxFQUFpQkMsRUFBZ0JDLEdBRS9FeEMsS0FBS3lDLE1BQVFOLEVBQ2JuQyxLQUFLMEMsTUFBUVAsRUFBS1EsS0FDbEIzQyxLQUFLNEMsTUFBUVQsRUFBS1UsS0FDbEI3QyxLQUFLOEMsT0FBU1gsRUFBS1ksTUFDbkIvQyxLQUFLZ0QsSUFBTWIsRUFBS2EsSUFDaEJoRCxLQUFLaUQsUUFBVWIsRUFDZnBDLEtBQUtrRCxTQUFXZixFQUFLZ0IsTUFBTUgsSUFHM0JoRCxLQUFLb0Qsc0JBQXdCZixFQUM3QnJDLEtBQUtxRCxpQkFBbUJmLEVBQ3hCdEMsS0FBS3NELGdCQUFrQmYsRUFDdkJ2QyxLQUFLdUQsbUJBQXFCZixFQUc1QmdCLFFBQ0UsT0FBT3hELEtBQUtnRCxJQUdkUyxlQUNFLE9BQU83RSxTQUFTQyxjQUFjbUIsS0FBS29ELHVCQUNoQ00sUUFBUTdFLGNBQWMsbUJBRzNCOEUscUJBQ0UzRCxLQUFLNEQsWUFBWXhDLGlCQUFpQixTQUFTLElBQU1wQixLQUFLc0Qsb0JBQ3REdEQsS0FBSzZELGNBQWN6QyxpQkFBaUIsU0FBUyxJQUFNcEIsS0FBS3VELG1CQUFtQnZELFFBQzNFQSxLQUFLOEQsV0FBVzFDLGlCQUFpQixTQUFTLElBQU1wQixLQUFLcUQsaUJBQWlCckQsS0FBSzBDLE1BQU8xQyxLQUFLNEMsU0FHekZtQixhQUNFL0QsS0FBS2dFLGFBQWF4RCxTQUNsQlIsS0FBS2dFLGFBQWUsS0FHdEJDLGVBQWVDLEdBQ2JsRSxLQUFLOEMsT0FBU29CLEVBRWQsTUFBTUMsRUFBY25FLEtBQUs4QyxPQUFPc0IsT0FDaENwRSxLQUFLcUUsaUJBQWlCOUQsWUFBYzRELEVBRUhuRSxLQUFLc0UsVUFFcEN0RSxLQUFLNEQsWUFBWXZELFVBQVVDLElBQUksZ0NBRS9CTixLQUFLNEQsWUFBWXZELFVBQVVHLE9BQU8sZ0NBSXRDOEQsVUFDRSxPQUFPdEUsS0FBSzhDLE9BQU95QixNQUFLQyxHQUFRQSxFQUFLeEIsTUFBUWhELEtBQUtpRCxVQUlwRHdCLGVBcUJFLE9BcEJBekUsS0FBS2dFLGFBQWVoRSxLQUFLeUQsZUFBZWlCLFdBQVUsR0FFbEQxRSxLQUFLOEQsV0FBYTlELEtBQUtnRSxhQUFhbkYsY0FBYyxvQkFDbERtQixLQUFLMkUsVUFBWTNFLEtBQUtnRSxhQUFhbkYsY0FBYyx3QkFDakRtQixLQUFLNEQsWUFBYzVELEtBQUtnRSxhQUFhbkYsY0FBYywwQkFDbkRtQixLQUFLNkQsY0FBZ0I3RCxLQUFLZ0UsYUFBYW5GLGNBQWMsNEJBQ3JEbUIsS0FBS3FFLGlCQUFvQnJFLEtBQUtnRSxhQUFhbkYsY0FBYyx5QkFHekRtQixLQUFLOEQsV0FBV2MsSUFBTTVFLEtBQUs0QyxNQUMzQjVDLEtBQUs4RCxXQUFXZSxJQUFNN0UsS0FBSzBDLE1BQzNCMUMsS0FBSzJFLFVBQVVwRSxZQUFjUCxLQUFLMEMsTUFFbEMxQyxLQUFLMkQscUJBQ0wzRCxLQUFLaUUsZUFBZWpFLEtBQUs4QyxRQUV0QjlDLEtBQUtpRCxVQUFZakQsS0FBS2tELFdBQ3ZCbEQsS0FBSzZELGNBQWNpQixNQUFNQyxRQUFVLFFBRzlCL0UsS0FBS2dFLGNDOUVoQixNQUVNZ0IsRUFBdUIsYUFFdEIsTUFBTUMsRUFDWHJGLFlBQVlzRixHQUNWbEYsS0FBS21GLE9BQVN2RyxTQUFTQyxjQUFjcUcsR0FDckNsRixLQUFLb0YsZ0JBQWtCcEYsS0FBS29GLGdCQUFnQkMsS0FBS3JGLE1BR25Eb0YsZ0JBQWdCckQsR0FDRSxXQUFaQSxFQUFJdUQsS0FDTnRGLEtBQUt1RixRQUlUQyxPQUNFeEYsS0FBS21GLE9BQU85RSxVQUFVQyxJQUFJMEUsR0FDMUJwRyxTQUFTd0MsaUJBQWlCLFVBQVdwQixLQUFLb0YsaUJBRzVDRyxRQUNFdkYsS0FBS21GLE9BQU85RSxVQUFVRyxPQUFPd0UsR0FDN0JwRyxTQUFTNkcsb0JBQW9CLFVBQVd6RixLQUFLb0YsaUJBRy9DTSxvQkFDRTFGLEtBQUttRixPQUFPL0QsaUJBQWlCLGFBQWNXLEtBRXZDQSxFQUFJNEQsT0FBT3RGLFVBQVV1RixTQTdCVCxVQThCWjdELEVBQUk0RCxPQUFPdEYsVUFBVXVGLFNBN0JGLGtCQStCbkI1RixLQUFLdUYsWUM5Qk4sTUFBTU0sVUFBc0JaLEVBQ2pDckYsWUFBWXNGLEVBQWVZLEdBQ3pCQyxNQUFNYixHQUVObEYsS0FBS2dHLGtCQUFvQkYsRUFDekI5RixLQUFLaUcsTUFBUWpHLEtBQUttRixPQUFPdEcsY0FBYyxnQkFDdkNtQixLQUFLa0csUUFBVWxHLEtBQUtpRyxNQUFNaEYsaUJBQWlCLGlCQUMzQ2pCLEtBQUsyQixjQUFnQjNCLEtBQUttRixPQUFPdEcsY0FBYyxnQkFJakRzSCxrQkFDRSxNQUFNQyxFQUFTLEdBUWYsT0FMQXBHLEtBQUtrRyxRQUFRL0UsU0FBU3JCLElBQ3BCLE1BQU13RixFQUFNeEYsRUFBTU0sR0FDWmlHLEVBQVF2RyxFQUFNdUcsTUFDcEJELEVBQU9kLEdBQU9lLEtBRVRELEVBR1RWLG9CQUNJSyxNQUFNTCxvQkFFTjFGLEtBQUtpRyxNQUFNN0UsaUJBQWtCLFVBQVdrRixJQUVwQ0EsRUFBRXRFLGlCQUVGaEMsS0FBS2dHLGtCQUFrQmhHLEtBQUttRyxzQkFJcENJLGVBQWVwRSxHQUNibkMsS0FBS2tHLFFBQVEvRSxTQUFTckIsSUFDcEJBLEVBQU11RyxNQUFRbEUsRUFBS3JDLEVBQU02QyxTQUk3QjZELG9CQUFvQkMsR0FDbEJ6RyxLQUFLZ0csa0JBQW9CUyxFQUczQkMsV0FBV0MsR0FDVCxNQUFNQyxFQUFTNUcsS0FBSzJCLGNBR1IsV0FBVGdGLElBQ0RDLEVBQU9yRyxZQUFjLGFBRVgsWUFBVG9HLElBQ0RDLEVBQU9yRyxZQUFjLFFBY3pCZ0YsUUFDSVEsTUFBTVIsUUFDTnZGLEtBQUtpRyxNQUFNWSxTQ2dDVixNQUFNQyxFQUFNLElBdEduQixNQUNFbEgsWUFBWW1ILEcsVUFrQkUsQ0FBQ3BFLEVBQU1xRSxJQUNaQyxNQUFNakgsS0FBS2tILFNBQVcsWUFBYSxDQUN4Q0MsT0FBUSxRQUNSQyxRQUFTcEgsS0FBS3FILFNBQ2RDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkI3RSxPQUNBcUUsWUFHSFMsS0FBS3pILEtBQUswSCxnQkFDVkQsTUFBS0UsR0FBT0EsRUFBSUMsVSxFQTVCRSxzQixzQkFBQSxLLHVEQUFBLEssS0FDbkI1SCxLQUFLa0gsU0FBV0gsRUFBUWMsUUFDeEI3SCxLQUFLcUgsU0FBV04sRUFBUUssUUFDeEJwSCxLQUFLMEgsZUFBaUJYLEVBQVFlLGNBS2hDQyxjQUNFLE9BQU9kLE1BQU1qSCxLQUFLa0gsU0FBVyxZQUFhLENBQ3hDRSxRQUFTcEgsS0FBS3FILFdBQ2JJLEtBQUt6SCxLQUFLMEgsZ0JBQ1pELE1BQUtFLEdBQU9BLEVBQUlDLFNBbUJuQkksV0FBV0MsR0FDVCxPQUFPaEIsTUFBTWpILEtBQUtrSCxTQUFXLG1CQUFvQixDQUMvQ0MsT0FBUSxRQUNSQyxRQUFTcEgsS0FBS3FILFNBQ2RDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJTLGFBR0hSLEtBQUt6SCxLQUFLMEgsZ0JBQ1ZELE1BQUtFLEdBQU9BLEVBQUlDLFNBR25CTSxrQkFDRSxPQUFPakIsTUFBTWpILEtBQUtrSCxTQUFXLFNBQVUsQ0FDckNFLFFBQVNwSCxLQUFLcUgsV0FFZkksS0FBS3pILEtBQUswSCxnQkFDVkQsTUFBS0UsR0FBT0EsRUFBSUMsU0FHbkJPLFFBQVF4RixFQUFNRSxHQUNaLE9BQU9vRSxNQUFNakgsS0FBS2tILFNBQVcsU0FBVSxDQUNyQ0MsT0FBUSxPQUNSQyxRQUFTcEgsS0FBS3FILFNBQ2RDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkI3RSxPQUNBRSxXQUdINEUsS0FBS3pILEtBQUswSCxnQkFDVkQsTUFBS0UsR0FBT0EsRUFBSUMsU0FHbkJRLFFBQVFoSSxHQUNOLE9BQU82RyxNQUFNakgsS0FBS2tILFNBQVcsZ0JBQWtCOUcsRUFBSSxDQUNqRCtHLE9BQVEsTUFDUkMsUUFBU3BILEtBQUtxSCxXQUVmSSxLQUFLekgsS0FBSzBILGdCQUNWRCxNQUFLRSxHQUFPQSxFQUFJQyxTQUduQlMsV0FBV2pJLEdBQ1QsT0FBTzZHLE1BQU1qSCxLQUFLa0gsU0FBVyxnQkFBa0I5RyxFQUFJLENBQ2pEK0csT0FBUSxTQUNSQyxRQUFTcEgsS0FBS3FILFdBRWZJLEtBQUt6SCxLQUFLMEgsZ0JBQ1ZELE1BQUtFLEdBQU9BLEVBQUlDLFNBR25CVSxXQUFXbEksR0FDVCxPQUFPNkcsTUFBTWpILEtBQUtrSCxTQUFXLFVBQVk5RyxFQUFJLENBQzNDK0csT0FBUSxTQUNSQyxRQUFTcEgsS0FBS3FILFdBRWZJLEtBQUt6SCxLQUFLMEgsZ0JBQ1ZELE1BQUtFLEdBQU9BLEVBQUlDLFNBR25CRixlQUFlQyxHQUNiLE9BQUlBLEVBQUlZLEdBQ0NaLEVBQUlDLE9BRUpZLFFBQVFDLE9BQU9kLEVBQUllLGNBTUwsQ0FDekJiLFFBQVMsaURBQ1RULFFBQVMsQ0FDUHVCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JDM0ZwQixJQUFJdkcsRUFHSm9HLFFBQVFJLElBQUksQ0FBQzlCLEVBQUlpQixjQUFlakIsRUFBSW9CLG9CQUNqQ1QsTUFBSyxJQUF1QixJQUFyQm9CLEVBQVVDLEdBQVcsRUFDM0IxRyxFQUFTeUcsRUFBUzdGLElBRWxCK0YsRUFBU0MsWUFBWUgsRUFBU2xHLEtBQU9rRyxFQUFTN0IsTUFBTzZCLEVBQVNaLFFBQzlEZ0IsRUFBUUMsY0FBY0osTUFFdkJLLE1BQU1DLFFBQVFDLEtBR2pCLE1BQU1DLEVBQW9CLElBQUlDLEVBQWVwSyxFQUFVTSxHQUNqRCtKLEVBQXVCLElBQUlELEVBQWVwSyxFQUFVTyxHQUNwRCtKLEVBQXNCLElBQUlGLEVBQWVwSyxFQUFXUSxHQUUxRDJKLEVBQWtCeEgsbUJBQ2xCMEgsRUFBcUIxSCxtQkFDckIySCxFQUFvQjNILG1CQUNwQndILEVBQWtCekgsa0JBR2xCLE1Bc0VNVyxFQUFxQmtILElBQ3pCQyxFQUFrQm5FLE9BRWxCbUUsRUFBa0JuRCxxQkFBb0IsS0FDcENNLEVBQUl3QixXQUFXb0IsRUFBS2xHLFNBQ25CaUUsTUFBTSxLQUNMaUMsRUFBSzNGLGdCQUVQNEYsRUFBa0JwRSxZQUtoQnFFLEVBQW1CLElBQUkvRCxFQUFjLG1CQWxFVjFELElBQy9CeUgsRUFBaUJsRCxXQUFXLFVBQzVCSSxFQUFJK0MsWUFBWTFILEVBQUtRLEtBQU1SLEVBQUsySCxZQUM3QnJDLE1BQU1FLElBQ0xvQixFQUFTQyxZQUFZckIsRUFBSWhGLEtBQU1SLEVBQUsySCxXQUFZbkMsRUFBSU0sV0FFckRSLE1BQU1FLElBQ0xpQyxFQUFpQnJFLE1BQU1vQyxNQUV4QndCLE1BQU1DLFFBQVFDLEtBQ2RVLFNBQVMsS0FDUkgsRUFBaUJsRCxXQUFXLGlCQXdEbENrRCxFQUFpQmxFLG9CQUVqQixNQUFNc0UsRUFBb0IsSUFBSW5FLEVBQWMsMEJBckRoQjFELElBQzFCNkgsRUFBa0J0RCxXQUFXLFVBQzdCSSxFQUFJa0IsV0FBWTdGLEVBQUtVLE1BQ2xCNEUsTUFBTUUsSUFDTG9CLEVBQVNDLFlBQVlyQixFQUFJaEYsS0FBTWdGLEVBQUlYLE1BQU9XLEVBQUlNLFFBQzlDK0IsRUFBa0J0RCxXQUFXLGNBRTlCeUMsTUFBTUMsUUFBUUMsS0FDZFUsU0FBUyxLQUNSQyxFQUFrQnpFLGNBNkN4QnlFLEVBQWtCdEUsb0JBRWxCLE1BQU11RSxFQUFlLElBQUlwRSxFQUFjLHdCQXpGYjFELElBQ3hCOEgsRUFBYXZELFdBQVcsVUFDeEJJLEVBQUlxQixRQUFRaEcsRUFBSytILFVBQVcvSCxFQUFLZ0ksZUFDOUIxQyxNQUFLRSxJQUNKc0IsRUFBUW1CLFFBQVF6QyxNQUVqQkYsTUFBTUUsSUFDTHNDLEVBQWExRSxNQUFNb0MsTUFFcEJ3QixNQUFNQyxRQUFRQyxLQUNkVSxTQUFVLEtBQ1RFLEVBQWF2RCxXQUFXLGlCQStFOUJ1RCxFQUFhdkUsb0JBRWIsTUFBTWlFLEVBQW9CLElBQUk5RCxFQUFjLDBCQUEyQnJELEdBQ3ZFbUgsRUFBa0JqRSxvQkFFbEIsTUFBTTJFLEVBQWEsSUNsSVosY0FBNkJwRixFQUNsQ3JGLFlBQVlzRixHQUNWYSxNQUFNYixHQUNObEYsS0FBS3NLLFVBQVl0SyxLQUFLbUYsT0FBT3RHLGNBQWMsb0JBQzNDbUIsS0FBS3VLLE9BQVN2SyxLQUFLbUYsT0FBT3RHLGNBQWMsaUJBSTFDMkcsS0FBSzdDLEVBQU1FLEdBRVRrRCxNQUFNUCxPQUNKeEYsS0FBS3VLLE9BQU8zRixJQUFNL0IsRUFDbEI3QyxLQUFLdUssT0FBTzFGLElBQU1sQyxFQUNsQjNDLEtBQUtzSyxVQUFVL0osWUFBY29DLElEcUhHLGdCQUN0QzBILEVBQVczRSxvQkFHWCxNQWNNdUQsRUFBVSxJRXRKVCxNQUNMckosWUFBWSxFQUFjNEssR0FBWSxJQUExQixTQUFFQyxHQUF3QixFQUNwQ3pLLEtBQUswSyxVQUFZRCxFQUNqQnpLLEtBQUsySyxXQUFhL0wsU0FBU0MsY0FBYzJMLEdBSzNDdEIsY0FBYzBCLEdBQ1pBLEVBQU16SixTQUFTZ0IsSUFDWG5DLEtBQUtvSyxRQUFRakksTUFJbkJpSSxRQUFRakksR0FDTixNQUFNMEksRUFBVTdLLEtBQUswSyxVQUFVdkksR0FDL0JuQyxLQUFLMkssV0FBV0csUUFBUUQsS0ZzSUMsQ0FBRUosU0FkWHRJLElBQ2xCLE1BQU00SSxFQUFPLElBQUk3SSxFQUNmQyxFQUNBQyxFQUNBLGtCQUNBLElBekRxQkQsS0FDdkJrSSxFQUFXN0UsS0FBS3JELEVBQUtRLEtBQU1SLEVBQUtVLE9Bd0R4QlAsQ0FBZ0JILEtBQ3RCLEtBckRvQnVILFNBcURDcUIsR0FwRGZ6RyxVQUNOd0MsRUFBSXVCLFdBQVdxQixFQUFLbEcsU0FDakJpRSxNQUFLRSxJQUNKK0IsRUFBS3pGLGVBQWUwRCxFQUFJNUUsVUFFekJvRyxNQUFNQyxRQUFRQyxLQUVqQnZDLEVBQUlzQixRQUFRc0IsRUFBS2xHLFNBQ2RpRSxNQUFLRSxJQUNKK0IsRUFBS3pGLGVBQWUwRCxFQUFJNUUsVUFFekJvRyxNQUFNQyxRQUFRQyxRQTBDaEJqSixHQUFPb0MsRUFBa0JwQyxLQUU3QixPQUFPMkssRUFBS3RHLGlCQUswQyxvQkFFakRzRSxFQUFXLElHekpWLE1BQ0xuSixZQUFZLEdBQ1osSUFEWSxvQkFBQ29MLEVBQUQsMEJBQXNCQyxFQUF0QixjQUFpRHRNLEdBQzdELEVBQ0VxQixLQUFLa0wsYUFBY3RNLFNBQVNDLGNBQWNtTSxHQUMxQ2hMLEtBQUttTCxtQkFBcUJ2TSxTQUFTQyxjQUFjb00sR0FDakRqTCxLQUFLb0wsZUFBZ0J4TSxTQUFTQyxjQUFjRixHQUc5Q29KLGNBQ0UsTUFBTyxDQUNMcEYsS0FBTTNDLEtBQUtrTCxhQUFhM0ssWUFDeEJ1SixXQUFZOUosS0FBS21MLG1CQUFtQjVLLFlBQ3BDMEgsT0FBUWpJLEtBQUtvTCxlQUFldEcsTUFBTXVHLGlCQUl0Q3JDLFlBQVlyRyxFQUFNbUgsRUFBWTdCLEdBQzVCakksS0FBS2tMLGFBQWEzSyxZQUFjb0MsRUFDaEMzQyxLQUFLbUwsbUJBQW1CNUssWUFBY3VKLEVBQ3RDOUosS0FBS29MLGVBQWV0RyxNQUFNdUcsZ0JBQTFCLGNBQW1EcEQsRUFBbkQsT0hzSTBCLENBQzVCK0Msb0JBQXFCLG1CQUNyQkMsMEJBQTJCLHVCQUMzQnRNLGNBQWUsb0JBZWpCSSxFQUFXcUMsaUJBQWlCLFNBWjVCLFdBQ0UsTUFBTWtLLEVBQWN2QyxFQUFTaEIsY0FFN0IvSSxFQUFVcUgsTUFBUWlGLEVBQVkzSSxLQUM5QjFELEVBQWdCb0gsTUFBUWlGLEVBQVl4QixXQUVwQ1IsRUFBa0J6SCxrQkFDbEJ5SCxFQUFrQjdILGVBQ2xCbUksRUFBaUJwRSxVQU1uQnRHLEVBQVVrQyxpQkFBaUIsU0FBUyxLQUNsQ29JLEVBQXFCM0gsa0JBQ3JCMkgsRUFBcUI5SCxnQkFDckJ1SSxFQUFhekUsVUFHZjdHLEVBQWN5QyxpQkFBaUIsU0FBUyxLQUN0Q3FJLEVBQW9CNUgsa0JBQ3BCNEgsRUFBb0IvSCxnQkFDcEJzSSxFQUFrQnhFLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL3BhZ2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL0ZvciBQcm9maWxlIGFuZCBwb3B1cCBlbGVtZW50c1xuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9wcm9maWxlXCIpOyAvLy5wb3B1cCBiYXN0YWtpIHNpbGluZGlcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcbmNvbnN0IGNsb3NlQnV0dG9uID0gcHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpO1xuY29uc3QgaW5wdXROYW1lID0gcHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiKTtcbmNvbnN0IGlucHV0UHJvZmVzc2lvbiA9IHByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX3Byb2Zlc3Npb25cIik7XG5cbi8vIC8vLy8vQ0FSRFNcblxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtYnV0dG9uXCIpO1xuXG4vLyBXcmFwcGVyc1xuY29uc3QgZWxlbWVudHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fY2FyZHNcIik7XG5cbmNvbnN0IHNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX3NhdmVfZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl9vcGVuXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmNvbnN0IGVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9lZGl0XCIpO1xuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX2NhcmRzXCIpO1xuY29uc3QgYXZhdGFyQ2hhbmdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9hdmF0YXJcIik7XG5cblxuZXhwb3J0IHtcbiAgc2V0dGluZ3MsIGVkaXRGb3JtLCBhZGRDYXJkRm9ybSwgYXZhdGFyQ2hhbmdlLCBlZGl0QnV0dG9uLCBjbG9zZUJ1dHRvbiwgaW5wdXROYW1lLCBpbnB1dFByb2Zlc3Npb24sXG4gIGFkZEJ1dHRvbiwgZWxlbWVudHNMaXN0LCBwcm9maWxlQXZhdGFyXG59O1xuXG5cblxuLy9jb25zdCBwcm9maWxlSW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mb1wiKTtcbi8vIGNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZUluZm8ucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19oZWFkZXJcIik7XG4vLyBjb25zdCBwcm9maWxlUHJvZmVzc2lvbiA9IHByb2ZpbGVJbmZvLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcHJvZmVzc2lvblwiKTtcbi8vIGNvbnN0IHBvcHVwTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIik7XG4vLyBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zLnByb2ZpbGVGb3JtOyAvL3F1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9mb3JtJyk7Ly9cbi8vIGNvbnN0IHBvcHVwU2VsZWN0b3IgPSBcInBvcHVwX29wZW5cIjtcblxuXG4vLyBjb25zdCBDYXJkX1RlbXBsYXRlX1NlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiO1xuLy8gY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlLXByZXZpZXdcIik7XG4vLyBjb25zdCBjYXJkRGVsZXRlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfY29uZmlybS1kZWxldGVcIik7XG4vLyBjb25zdCBkZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b25fZGVsZXRlXCIpXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXQsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcblxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xuXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dCkgPT4ge1xuICAgIGlmICghaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0LCBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgaW5wdXRTZWxlY3RvciB9ID0gdGhpcy5fc2V0dGluZ3M7XG5cbiAgICB0aGlzLmlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpXG4gICAgKTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpOyAvL21ldGhvZCBjaGVja1xuXG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgX2hhc1ZhbGlkSW5wdXQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMuaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xuICB9O1xuXG4gIF90b2dnbGVCdXR0b24gPSAoKSA9PiB7XG4gICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gaW5hY3RpdmVCdXR0b25DbGFzcztcblxuICAgIGlmICh0aGlzLl9oYXNWYWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuZW5hYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfTtcblxuICBlbmFibGVCdXR0b24gPSAoKSA9PiB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH07XG5cbiAgZGlzYWJsZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9O1xuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLmlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCB1c2VySWQsIHRlbXBsYXRlQ2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUxpa2VJY29uLCBoYW5kbGVEZWxldGVDbGljaykge1xuICAgIC8vY29uc29sZS5sb2coXCJkYXRhXCIsIGRhdGEpO1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIC8vY29uc29sZS5sb2coXCJvd25lcklkXCIsIGRhdGEub3duZXIuX2lkKVxuXG4gICAgdGhpcy5fdGVtcGxhdGVDYXJkU2VsZWN0b3IgPSB0ZW1wbGF0ZUNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUljb24gPSBoYW5kbGVMaWtlSWNvbjtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkXG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVDYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2NhcmQnKTtcbiAgfVxuXG4gIF9hZGRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUljb24oKSk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKSk7XG4gIH1cblxuICByZW1vdmVDYXJkKCl7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgc2V0TGlrZUNvdW50ZXIobmV3TGlrZXMpIHsgICAvL2xlbmd0aCBrxLFzbcSxbsSxIG9rdXlhbcSxeW9yIGthcnQgZWtsZW5lbWl5b3IgLSBoYW5kbGVjYXJkc3VibWl0IGZvbmtzaXlvbnVuYSBsaWtlcyB2ZSBfaWQgZWtsZXllcmVrIMOnw7Z6ZMO8IF5eKytcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xuXG4gICAgY29uc3QgbGlrZUNvdW50ZXIgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgdGhpcy5fY2FyZExpa2VDb3VudGVyLnRleHRDb250ZW50ID0gbGlrZUNvdW50ZXI7XG5cbiAgICBjb25zdCBsaWtlQ2xpY2tlZGJ5Q3VycmVudFVzZXIgPSB0aGlzLmlzTGlrZWQoKTtcbiAgICBpZihsaWtlQ2xpY2tlZGJ5Q3VycmVudFVzZXIpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnZWxlbWVudHNfX2J1dHRvbi1saWtlX2FjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2VsZW1lbnRzX19idXR0b24tbGlrZV9hY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBpc0xpa2VkKCl7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2ltYWdlJyk7XG4gICAgdGhpcy5fY2FyZE5hbWUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2NhcmQtdGV4dCcpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2J1dHRvbi1saWtlJyk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX19idXR0b24tZGVsZXRlJyk7XG4gICAgdGhpcy5fY2FyZExpa2VDb3VudGVyID0gIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fY2FyZF9saWtlcycpO1xuXG4gICAgLy9jYXJkIC8vIGRlc3RydWN0dXJpbmcgYXNzaWdubWVudC8vXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZE5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLnNldExpa2VDb3VudGVyKHRoaXMuX2xpa2VzKTtcblxuICAgIGlmKHRoaXMuX3VzZXJJZCAhPT0gdGhpcy5fb3duZXJJZCkge1xuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScgLy8gZWxlbWVudHNfX2J1dHRvbi1kZWxldGVcbiAgICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cblxuIiwiY29uc3QgUE9QVVBfQ0xBU1MgPSAncG9wdXAnO1xuY29uc3QgQ0xPU0VfQlVUVE9OX0NMQVNTID0gJ3BvcHVwX19jbG9zZSc7XG5jb25zdCBQT1BVUF9TRUxFQ1RPUl9DTEFTUyA9ICdwb3B1cF9vcGVuJztcblxuZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKVxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKVxuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFBPUFVQX1NFTEVDVE9SX0NMQVNTKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShQT1BVUF9TRUxFQ1RPUl9DTEFTUyk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhQT1BVUF9DTEFTUykgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoQ0xPU0VfQlVUVE9OX0NMQVNTKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG4vLyoqKiBtb3VzZWRvd24gcmVwbGFjZWQgY2xpY2sgdG8gcHJldmVudCB0aGUgYnVnIGlmIHlvdSBjbGljayBpbnNpZGUgYSBwb3B1cCBhbmQgdGhlbiBtb3ZlIHlvdXIgbW91c2Ugb3V0c2lkZSBpdFxuLy8gYW5kIHJlbGVhc2UgdGhlIGJ1dHRvbiBhYm92ZSB0aGUgb3ZlcmxheSB0aGVuIHRoZSBwb3B1cCBjbG9zZXMgYnV0IGl04oCZcyBub3RcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdEZvcm0gKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3RvcilcblxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gPSBoYW5kbGVTdWJtaXRGb3JtXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpXG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JylcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUnKVxuICAgIC8vIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0LnRleHRDb250ZW50XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgdmFsdWVzID0ge31cblxuXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBpbnB1dC5pZFxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZVxuICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZVxuICAgIH0pXG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG4gICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoICdzdWJtaXQnLCAoZSkgPT4ge1xuICAgICAgICAgIC8vY29uc29sZS5sb2coJ2lucHV0IHRha2VuJylcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0odGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKXtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KVxuICB9XG5cbiAgY2hhbmdlU3VibWl0SGFuZGxlcihuZXdTdWJtaXRIYW5kbGVyKSB7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSA9IG5ld1N1Ym1pdEhhbmRsZXJcbiAgfVxuXG4gIGNoYW5nZVRleHQodGV4dCkge1xuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuX3N1Ym1pdEJ1dHRvbjtcbiAgICAvLyB0aGlzLnJlbmRlckxvYWRpbmcoKVxuXG4gICAgaWYodGV4dCA9PT0gJ1NhdmluZycpIHtcbiAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZpbmcuLi4nXG4gICAgfVxuICAgIGlmKHRleHQgPT09ICdEZWZhdWx0Jykge1xuICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ1NhdmUnXG4gICAgfVxuICB9XG5cblxuICAvLyByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQ9J1NhdmluZy4uLicpIHtcbiAgLy8gICBjb25zdCBidXR0b24gPSB0aGlzLl9zdWJtaXRCdXR0b247XG4gIC8vICAgaWYgKGlzTG9hZGluZykge1xuICAvLyAgICAgdGhpcy5idXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgLy8gICB9IGVsc2Uge1xuICAvLyAgICAgdGhpcy5idXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b247XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgY2xvc2UoKSB7XG4gICAgICBzdXBlci5jbG9zZSgpXG4gICAgICB0aGlzLl9mb3JtLnJlc2V0KClcbiAgfVxuXG59XG5cbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVyc1xuICAgIHRoaXMuX2NoZWNrUmVzcG9uc2UgPSBvcHRpb25zLmNoZWNrUmVzcG9uc2VcbiAgfVxuXG5cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUnLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICAgIC8vIC5jYXRjaChlcnIgPT4ge1xuICAgIC8vICAgY29uc29sZS5sb2coJ0FwaSBoYXMgYW4gZXJyb3IhISEnKVxuICAgIC8vIH0pXG4gIH1cblxuICBlZGl0UHJvZmlsZSA9IChuYW1lLCBhYm91dCkgPT4ge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy91c2Vycy9tZScsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KVxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgfVxuXG4gIGVkaXRBdmF0YXIoYXZhdGFyKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL3VzZXJzL21lL2F2YXRhcicsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyXG4gICAgICB9KVxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMnLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICB9IC8vbmFtZSAgJiBsaW5rIGluIHRoZSBib2R5IGNoZWNrIG0uXG5cbiAgYWRkQ2FyZChuYW1lLCBsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL2NhcmRzJywge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KVxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgfVxuXG4gIGFkZExpa2UoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvbGlrZXMvJyArIGlkLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICB9XG5cbiAgcmVtb3ZlTGlrZShpZCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcy9saWtlcy8nICsgaWQsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gIH1cblxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL2NhcmRzLycgKyBpZCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcyl7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KTtcbiAgICB9XG4gIH1cbn1cblxuXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI5Mzk4YTQ4My00ODRlLTRlYmQtYTM3NC1iNmIzYjk4NWU5YzRcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9XG59KTsgLy8gdGhpcy5fYmFzZVVybCAvLyB0aGlzLl9oZWFkZXJzXG4iLCJcbmltcG9ydCBcIi4uL3BhZ2UvaW5kZXguY3NzXCI7IC8vIG1haW4gYnJpZGdlIHRvIGNzcyBmaWxlcyBhZnRlciB3ZWJwYWNrIGJ1aWxkIGFsd2F5cyBpbnN0YWxsIDFzdFxuXG5pbXBvcnQgeyBzZXR0aW5ncywgZWRpdEZvcm0sIGFkZENhcmRGb3JtLCBlZGl0QnV0dG9uLCBpbnB1dE5hbWUsIGlucHV0UHJvZmVzc2lvbixcbiAgICAgICAgIGFkZEJ1dHRvbiwgcHJvZmlsZUF2YXRhciwgYXZhdGFyQ2hhbmdlIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vY29tcG9uZW50cy9DYXJkLmpzJztcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cbmltcG9ydCB7IGFwaSwgQXBpIH0gZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xuLy9pbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwXCI7XG5cbmxldCB1c2VySWRcblxuLy9hcGkuZ2V0VXNlckluZm8gJiBhcGkuZ2V0SW5pdGlhbENhcmRzIGNvbWJpbmVkIHdpdGggUHJvbWlzZS5cblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkIC8vY29uc29sZS5sb2coJ3VzZXIgPT4nLCB1c2VyRGF0YSlcblxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsICB1c2VyRGF0YS5hYm91dCwgdXNlckRhdGEuYXZhdGFyKVxuICAgIHNlY3Rpb24ucmVuZGVyZXJJdGVtcyhjYXJkcylcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUubG9nKVxuXG4vL2Zvcm0gdmFsaWRhdG9yIHNldHRpbmdzIGRvbSByZWZlcmVuY2VzLy9cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoIHNldHRpbmdzLCBlZGl0Rm9ybSApO1xuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvciggc2V0dGluZ3MsIGFkZENhcmRGb3JtICk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoIHNldHRpbmdzLCAgYXZhdGFyQ2hhbmdlICk7XG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG5cbi8vIGhhbmRsZSBhZGRjYXJkc3VibWl0ICAgLy9kZW5lbWVcbmNvbnN0IGhhbmRsZUNhcmRTdWJtaXQgPSAoZGF0YSkgPT4ge1xuICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dCgnU2F2aW5nJylcbiAgYXBpLmFkZENhcmQoZGF0YS5jYXJkVGl0bGUsIGRhdGEuY2FyZEltYWdlTGluaylcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKHJlcylcbiAgICB9KVxuICAgIC50aGVuKCByZXMgPT4ge1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKHJlcyk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkgKCAoKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dCgnRGVmYXVsdCcpO1xuICAgIH0pXG5cblxufVxuLy9oYW5kbGUgZWRpdHByb2ZpbGUgc3VibWl0XG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dCgnU2F2aW5nJylcbiAgYXBpLmVkaXRQcm9maWxlKGRhdGEubmFtZSwgZGF0YS5wcm9mZXNzaW9uKVxuICAgIC50aGVuKCByZXMgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIGRhdGEucHJvZmVzc2lvbiwgcmVzLmF2YXRhcilcbiAgICB9KVxuICAgIC50aGVuKCByZXMgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZShyZXMpXG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkoICgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dCgnRGVmYXVsdCcpXG4gICAgfSlcbn07XG5cbi8vIGhhbmRsZSBhdmF0YXIgUGljdHVyZSBTdWJtaXRcbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gIGF2YXRhckNoYW5nZVBvcHVwLmNoYW5nZVRleHQoJ1NhdmluZycpXG4gIGFwaS5lZGl0QXZhdGFyKCBkYXRhLmxpbmspXG4gICAgLnRoZW4oIHJlcyA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0LCByZXMuYXZhdGFyKVxuICAgICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dCgnRGVmYXVsdCcpXG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkoICgpID0+IHtcbiAgICAgIGF2YXRhckNoYW5nZVBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbn07XG5cbi8vaGFuZGxlIENhcmQgQ2xpY2tcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChkYXRhKSA9PiB7XG4gIGltYWdlUG9wdXAub3BlbihkYXRhLm5hbWUsIGRhdGEubGluayk7XG59XG5cbi8vaGFuZGxlIENhcmQgTGlrZSBGdW5jdGlvblxuY29uc3QgaGFuZGxlTGlrZUljb24gPSAoY2FyZCkgPT4ge1xuICBpZihjYXJkLmlzTGlrZWQoKSkge1xuICAgIGFwaS5yZW1vdmVMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNhcmQuc2V0TGlrZUNvdW50ZXIocmVzLmxpa2VzKVxuICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gIH0gZWxzZSB7XG4gICAgYXBpLmFkZExpa2UoY2FyZC5nZXRJZCgpKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY2FyZC5zZXRMaWtlQ291bnRlcihyZXMubGlrZXMpXG4gICAgfSlcbiAgICAgIC5jYXRjaChjb25zb2xlLmxvZylcbiAgfVxuXG59XG5cbi8vIGhhbmRsZSBjb25maXJtIENhcmQgRGVsZXRlIEZ1bmN0aW9uXG5jb25zdCBoYW5kbGVEZWxldGVDbGljayA9IChjYXJkKSA9PiB7XG4gIGNvbmZpcm1DYXJkRGVsZXRlLm9wZW4oKVxuXG4gIGNvbmZpcm1DYXJkRGVsZXRlLmNoYW5nZVN1Ym1pdEhhbmRsZXIoKCkgPT4ge1xuICAgIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcbiAgICAudGhlbiggKCkgPT4ge1xuICAgICAgY2FyZC5yZW1vdmVDYXJkKClcbiAgICB9KVxuICAgIGNvbmZpcm1DYXJkRGVsZXRlLmNsb3NlKClcbiAgfSlcbn1cblxuLy9jbGFzcyBpbnN0YW5jZXMgb2YgUG9wdXBcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnI3BvcHVwLXRlbXBsYXRlJywgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpXG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcblxuY29uc3QgYXZhdGFyQ2hhbmdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnI3BvcHVwLXRlbXBsYXRlLWF2YXRhcicsIGhhbmRsZUF2YXRhclN1Ym1pdClcbmF2YXRhckNoYW5nZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cC10ZW1wbGF0ZS1mb3JtJywgaGFuZGxlQ2FyZFN1Ym1pdClcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpIC8vb25seSBjYWxsIG9uY2VcblxuY29uc3QgY29uZmlybUNhcmREZWxldGUgPSBuZXcgUG9wdXBXaXRoRm9ybSgnI3BvcHVwLXRlbXBsYXRlLWNvbmZpcm0nLCBoYW5kbGVEZWxldGVDbGljaylcbmNvbmZpcm1DYXJkRGVsZXRlLnNldEV2ZW50TGlzdGVuZXJzKClcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnI3BvcHVwLWltYWdlJylcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcbiAgY29uc3QgaXRlbSA9IG5ldyBDYXJkIChcbiAgICBkYXRhLFxuICAgIHVzZXJJZCxcbiAgICAnI2NhcmQtdGVtcGxhdGUnLFxuICAgICgpID0+IGhhbmRsZUNhcmRDbGljayhkYXRhKSwgICAgICAvLzR0aCBjb25zdHJ1Y3RvciBpdGVtIGhhbmRsZUNhcmRDbGlja1xuICAgICgpID0+IGhhbmRsZUxpa2VJY29uKGl0ZW0pLCAgICAgICAvLzV0aCAgY29uc3RydWN0b3IgaXRlbSBoYW5kbGVMaWtlSWNvblxuICAgIChpZCkgPT4gaGFuZGxlRGVsZXRlQ2xpY2soaWQpICAgICAvLzZ0aCBjb25zdHJjdXRvciBpdGVtIGhhbmRsZURlbGV0ZUNsaWNrXG4gIClcbiByZXR1cm4gaXRlbS5nZW5lcmF0ZUNhcmQoKTtcbn1cblxuXG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbiggeyByZW5kZXJlcjogY3JlYXRlQ2FyZCB9LCAnLmVsZW1lbnRzX19jYXJkcycgKVxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHByb2ZpbGVOYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9faGVhZGVyJyxcbiAgcHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvcjogJy5wcm9maWxlX19wcm9mZXNzaW9uJyxcbiAgcHJvZmlsZUF2YXRhcjogJy5wcm9maWxlX19pbWFnZScsXG59KVxuXG5mdW5jdGlvbiBvcGVuUHJvZmlsZVBvcHVwKCkge1xuICBjb25zdCBwcm9maWxlSW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG5cbiAgaW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZUluZm8ubmFtZTtcbiAgaW5wdXRQcm9mZXNzaW9uLnZhbHVlID0gcHJvZmlsZUluZm8ucHJvZmVzc2lvbjtcblxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlQnV0dG9uKCk7XG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xufVxuXG4vL0V2ZW50IGhhbmRsZXJzIHN1YnNjcmlwdGlvbnMgdG8gcG9wdXAvbW9kYWwgY29udHJvbHNcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZVBvcHVwKVxuXG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KVxuXG5wcm9maWxlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgYXZhdGFyQ2hhbmdlUG9wdXAub3BlbigpO1xufSlcblxuXG4iLCJcbmltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3RvcilcbiAgICB0aGlzLl9zdWJ0aXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc3VidGl0bGUnKTtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbiAgfVxuXG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG5cbiAgICBzdXBlci5vcGVuKClcbiAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XG4gICAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgICAgdGhpcy5fc3VidGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuXG4gIH1cblxufVxuIiwiXG5leHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyICkge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xuICB9XG5cblxuXG4gIHJlbmRlcmVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuYWRkSXRlbShkYXRhKVxuICAgIH0pXG4gIH07XG5cbiAgYWRkSXRlbShkYXRhKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGRhdGEpXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcbiAgfTtcblxuXG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7cHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvciwgcHJvZmlsZUF2YXRhcn0pXG4gIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZT0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlUHJvZmVzc2lvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZVByb2Zlc3Npb25TZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhcj0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlQXZhdGFyKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgcHJvZmVzc2lvbjogdGhpcy5fcHJvZmlsZVByb2Zlc3Npb24udGV4dENvbnRlbnQsXG4gICAgICBhdmF0YXI6IHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlXG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgcHJvZmVzc2lvbiwgYXZhdGFyKSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3Byb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcHJvZmVzc2lvbjtcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHthdmF0YXJ9KWA7XG4gIH1cblxuXG59XG4iXSwibmFtZXMiOlsicHJvZmlsZUF2YXRhciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByb2ZpbGVQb3B1cCIsImVkaXRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dFByb2Zlc3Npb24iLCJhZGRCdXR0b24iLCJzZXR0aW5ncyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZWRpdEZvcm0iLCJhZGRDYXJkRm9ybSIsImF2YXRhckNoYW5nZSIsImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dCIsImVycm9yTWVzc2FnZSIsInRoaXMiLCJfc2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwicmVtb3ZlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl90b2dnbGVCdXR0b24iLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJldmVyeSIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2hhc1ZhbGlkSW5wdXQiLCJlbmFibGVCdXR0b24iLCJkaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQ2FyZCIsImRhdGEiLCJ1c2VySWQiLCJ0ZW1wbGF0ZUNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VJY29uIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfZGF0YSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2lkIiwiX3VzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJfdGVtcGxhdGVDYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VJY29uIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiZ2V0SWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsInJlbW92ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJzZXRMaWtlQ291bnRlciIsIm5ld0xpa2VzIiwibGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJfY2FyZExpa2VDb3VudGVyIiwiaXNMaWtlZCIsImZpbmQiLCJ1c2VyIiwiZ2VuZXJhdGVDYXJkIiwiY2xvbmVOb2RlIiwiX2NhcmROYW1lIiwic3JjIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiUE9QVVBfU0VMRUNUT1JfQ0xBU1MiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Rm9ybSIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdEZvcm0iLCJfZm9ybSIsIl9pbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsImUiLCJzZXRJbnB1dFZhbHVlcyIsImNoYW5nZVN1Ym1pdEhhbmRsZXIiLCJuZXdTdWJtaXRIYW5kbGVyIiwiY2hhbmdlVGV4dCIsInRleHQiLCJidXR0b24iLCJyZXNldCIsImFwaSIsIm9wdGlvbnMiLCJhYm91dCIsImZldGNoIiwiX2Jhc2VVcmwiLCJtZXRob2QiLCJoZWFkZXJzIiwiX2hlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsImpzb24iLCJiYXNlVXJsIiwiY2hlY2tSZXNwb25zZSIsImdldFVzZXJJbmZvIiwiZWRpdEF2YXRhciIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImRlbGV0ZUNhcmQiLCJvayIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiYXV0aG9yaXphdGlvbiIsImFsbCIsInVzZXJEYXRhIiwiY2FyZHMiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwic2VjdGlvbiIsInJlbmRlcmVySXRlbXMiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJjYXJkIiwiY29uZmlybUNhcmREZWxldGUiLCJlZGl0UHJvZmlsZVBvcHVwIiwiZWRpdFByb2ZpbGUiLCJwcm9mZXNzaW9uIiwiZmluYWxseSIsImF2YXRhckNoYW5nZVBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlTGluayIsImFkZEl0ZW0iLCJpbWFnZVBvcHVwIiwiX3N1YnRpdGxlIiwiX2ltYWdlIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsIml0ZW0iLCJwcm9maWxlTmFtZVNlbGVjdG9yIiwicHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlUHJvZmVzc2lvbiIsIl9wcm9maWxlQXZhdGFyIiwiYmFja2dyb3VuZEltYWdlIiwicHJvZmlsZUluZm8iXSwic291cmNlUm9vdCI6IiJ9