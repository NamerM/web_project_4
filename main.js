!function(){"use strict";const e=document.querySelector(".profile__info"),t=(e.querySelector(".profile__header"),e.querySelector(".profile__profession"),document.querySelectorAll(".popup"),document.forms.profileForm,document.querySelector(".popup_type_profile")),s=document.querySelector(".profile__button"),r=(t.querySelector(".popup__close"),t.querySelector(".popup__input_type_name")),i=t.querySelector(".popup__input_type_profession"),o=document.querySelector(".popup_type-preview"),n=(document.querySelector(".popup_type_add-card"),document.querySelector(".add-button")),l=(document.querySelector(".popup__close.popup__close_preview"),document.querySelector(".popup__close.popup__close_add"),document.querySelector(".popup__input_type_title"),document.querySelector(".popup__input_type_link"),o.querySelector(".popup__image"),o.querySelector(".popup__subtitle"),document.querySelector(".elements__cards"),{inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input-error_open",errorClass:"popup__error_visible"}),a=document.querySelector(".popup__form_edit"),c=document.querySelector(".popup__form_cards");function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var _=class{constructor(e,t){u(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,errorClass:r}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(r),i.textContent=t,i.classList.add(s)})),u(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,r=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(s),r.classList.remove(t),r.textContent=""})),u(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),u(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.inputList=Array.from(this._formElement.querySelectorAll(e)),this._toggleButton(),this.inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),u(this,"_hasValidInput",(()=>this.inputList.every((e=>e.validity.valid)))),u(this,"_toggleButton",(()=>{const{inactiveButtonClass:e}=this._settings;this._inactiveButtonClass=e,this._hasValidInput()?this.enableButton():this.disableButton()})),u(this,"enableButton",(()=>{this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass)})),u(this,"disableButton",(()=>{this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass)})),this._settings=e,this._formElement=t,this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}resetValidation(){this.inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class h{constructor(e,t,s,r,i){d(this,"_handleCardDelete",(()=>{this._cardElement.remove()})),d(this,"_addEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._handleLikeIcon())),this._deleteButton.addEventListener("click",(()=>this._handleCardDelete())),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))})),this._data=e,this._name=e.name,this._link=e.link,this._likes=e.likes,this._id=e._id,this._userId=t,this._templateCardSelector=s,this._handleCardClick=r,this._handleLikeIcon=i}getId(){return this._id}_getTemplate(){return document.querySelector(this._templateCardSelector).content.querySelector(".elements__card")}setLikeCounter(e){this._likes=e;const t=this._likes.length;this._cardElement.querySelector(".elements__card_likes").textContent=t,this.isLiked()?this._likeButton.classList.add("elements__button-like_active"):this._likeButton.classList.remove("elements__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}generateCard(){return this._cardElement=this._getTemplate().cloneNode(!0),this._cardImage=this._cardElement.querySelector(".elements__image"),this._cardName=this._cardElement.querySelector(".elements__card-text"),this._likeButton=this._cardElement.querySelector(".elements__button-like"),this._deleteButton=this._cardElement.querySelector(".elements__button-delete"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName.textContent=this._name,this._addEventListeners(),this.setLikeCounter(this._likes),this._cardElement}}const p="popup_open";class m{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add(p),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove(p),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}}class f extends m{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=this._form.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.id,r=t.value;e[s]=r})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitForm(this._getInputValues())}))}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}close(){super.close(),this._form.reset()}}const y=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}getInitialCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}editProfile(e,t){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"9398a483-484e-4ebd-a374-b6b3b985e9c4","Content-Type":"application/json"}});let b;Promise.all([y.getUserInfo(),y.getInitialCards()]).then((e=>{let[t,s]=e;b=t._id,C.setUserInfo(t.name,t.about),g.rendererItems(s)})).catch(console.log);const k=new _(l,a),v=new _(l,c);k.enableValidation(),v.enableValidation(),k.resetValidation();const E=new f("#popup-template-form",(e=>{y.addCard(e.cardTitle,e.cardImageLink).then((e=>{console.log("res =>",e);const t={name:e.name,link:e.link,likes:e.likes,_id:e._id};g.addItem(t)})).catch(console.log),E.close()}));E.setEventListeners();const S=new f("#popup-template",(e=>{y.editProfile(e.name,e.profession).then((t=>{C.setUserInfo(e.name,e.profession)})).catch(console.log).finally((()=>{S.close()}))}));S.setEventListeners();const L=new class extends m{constructor(e){super(e),this._subtitle=this._popup.querySelector(".popup__subtitle"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._subtitle.textContent=e}}("#popup-image");L.setEventListeners();const g=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}rendererItems(e){e.forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}({renderer:e=>{const t=new h(e,b,"#card-template",((e,t)=>{L.open(e,t)}),(()=>{t.isLiked()?y.removeLike(t.getId()).then((e=>{t.setLikeCounter(e.likes)})):y.addLike(t.getId()).then((e=>{t.setLikeCounter(e.likes)}))}));return t.generateCard()}},".elements__cards"),C=new class{constructor(e){let{profileNameSelector:t,profileProfessionSelector:s}=e;this._profileName=document.querySelector(t),this._profileProfession=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,profession:this._profileProfession.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileProfession.textContent=t}}({profileNameSelector:".profile__header",profileProfessionSelector:".profile__profession"});s.addEventListener("click",(()=>{const e=C.getUserInfo();r.value=e.name,i.value=e.profession,k.resetValidation(),k.enableButton(),S.open()})),n.addEventListener("click",(()=>{v.resetValidation(),v.disableButton(),E.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVlzSyxXQUVwQ1QsRUFBa0J6RyxrQkFDbEJ5RyxFQUFrQjdHLGVBQ2xCcUgsRUFBaUI3RCxVQVFuQjdGLEVBQVVnQyxpQkFBaUIsU0FBUyxLQUNsQ29ILEVBQXFCM0csa0JBQ3JCMkcsRUFBcUI5RyxnQkFDckIrRyxFQUFheEQsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8veWFuZGV4LnByYWN0aWN1bS5wcm9qZWN0Ly4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly95YW5kZXgucHJhY3RpY3VtLnByb2plY3QvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3lhbmRleC5wcmFjdGljdW0ucHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vRm9yIFByb2ZpbGUgYW5kIHBvcHVwIGVsZW1lbnRzXG5jb25zdCBwcm9maWxlSW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mb1wiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZUluZm8ucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19oZWFkZXJcIik7XG5jb25zdCBwcm9maWxlUHJvZmVzc2lvbiA9IHByb2ZpbGVJbmZvLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcHJvZmVzc2lvblwiKTtcbmNvbnN0IHBvcHVwTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIik7XG5cbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMucHJvZmlsZUZvcm07IC8vcXVlcnlTZWxlY3RvcignLnBvcHVwX2Zvcm0nKTsvL1xuY29uc3QgcHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIik7IC8vLnBvcHVwIGJhc3Rha2kgc2lsaW5kaVxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uXCIpO1xuLy9jb25zdCBzYXZlQnV0dG9uID0gcHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZScpOyAgLy9ub3QgdXNlZC1zdWJtaXRCdXR0b25TZWxlY3RvciB1c2VkIGluIHNldHRpbmdzXG5jb25zdCBjbG9zZUJ1dHRvbiA9IHByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKTtcbmNvbnN0IGlucHV0TmFtZSA9IHByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XG5jb25zdCBpbnB1dFByb2Zlc3Npb24gPSBwcm9maWxlUG9wdXAucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2lucHV0X3R5cGVfcHJvZmVzc2lvblwiXG4pO1xuY29uc3QgcG9wdXBTZWxlY3RvciA9IFwicG9wdXBfb3BlblwiO1xuXG4vLyAvLy8vL0NBUkRTXG5jb25zdCBDYXJkX1RlbXBsYXRlX1NlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiO1xuY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlLXByZXZpZXdcIik7XG5jb25zdCBjYXJkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIik7XG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1idXR0b25cIik7XG5jb25zdCBwcmV2aWV3QnV0dG9uQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wb3B1cF9fY2xvc2UucG9wdXBfX2Nsb3NlX3ByZXZpZXdcIlxuKTtcbmNvbnN0IGJ1dHRvbkNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UucG9wdXBfX2Nsb3NlX2FkZFwiKTtcbmNvbnN0IGlucHV0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX3RpdGxlXCIpO1xuY29uc3QgaW5wdXRJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfbGlua1wiKTtcbmNvbnN0IHBvcHVwSW1hZ2UgPSBwcmV2aWV3SW1hZ2UucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG5jb25zdCBwb3B1cFRpdGxlID0gcHJldmlld0ltYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3N1YnRpdGxlXCIpO1xuLy8gV3JhcHBlcnNcbmNvbnN0IGVsZW1lbnRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2NhcmRzXCIpO1xuXG5jb25zdCBzZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc2F2ZVwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXQtZXJyb3Jfb3BlblwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5jb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fZWRpdFwiKTtcbmNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9jYXJkc1wiKTtcblxuZXhwb3J0IHtcbiAgc2V0dGluZ3MsIGVkaXRGb3JtLCBhZGRDYXJkRm9ybSwgZWRpdEJ1dHRvbiwgY2xvc2VCdXR0b24sIGlucHV0TmFtZSwgaW5wdXRQcm9mZXNzaW9uLCBhZGRCdXR0b24sIGVsZW1lbnRzTGlzdFxufTtcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dCwgZXJyb3JNZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xuXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG5cbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0KSA9PiB7XG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH1cbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5ncztcblxuICAgIHRoaXMuaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcilcbiAgICApO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7IC8vbWV0aG9kIGNoZWNrXG5cbiAgICB0aGlzLmlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBfaGFzVmFsaWRJbnB1dCA9ICgpID0+IHtcbiAgICByZXR1cm4gdGhpcy5pbnB1dExpc3QuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvbiA9ICgpID0+IHtcbiAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBpbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuXG4gICAgaWYgKHRoaXMuX2hhc1ZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5lbmFibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9O1xuXG4gIGVuYWJsZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfTtcblxuICBkaXNhYmxlQnV0dG9uID0gKCkgPT4ge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHVzZXJJZCwgdGVtcGxhdGVDYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUljb24pIHtcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuXG5cbiAgICB0aGlzLl90ZW1wbGF0ZUNhcmRTZWxlY3RvciA9IHRlbXBsYXRlQ2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkXG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVDYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2NhcmQnKTtcbiAgfVxuXG4gIF9oYW5kbGVDYXJkRGVsZXRlID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgX2FkZEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlSWNvbigpKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlKCkpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKSk7XG4gIH1cblxuICBzZXRMaWtlQ291bnRlcihuZXdMaWtlcykgeyAgIC8vbGVuZ3RoIGvEsXNtxLFuxLEgb2t1eWFtxLF5b3Iga2FydCBla2xlbmVtaXlvciAtIGhhbmRsZWNhcmRzdWJtaXQgZm9ua3NpeW9udW5hIGxpa2VzIHZlIF9pZCBla2xleWVyZWsgw6fDtnpkw7wgXl4rK1xuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG5cbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2NhcmRfbGlrZXMnKS50ZXh0Q29udGVudCA9IGxpa2VDb3VudGVyO1xuXG4gICAgY29uc3QgbGlrZUNsaWNrZWRieUN1cnJlbnRVc2VyID0gdGhpcy5pc0xpa2VkKCk7XG4gICAgaWYobGlrZUNsaWNrZWRieUN1cnJlbnRVc2VyKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2VsZW1lbnRzX19idXR0b24tbGlrZV9hY3RpdmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdlbGVtZW50c19fYnV0dG9uLWxpa2VfYWN0aXZlJyk7XG4gICAgfVxuICB9XG5cbiAgaXNMaWtlZCgpe1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5maW5kKHVzZXIgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19faW1hZ2UnKTtcbiAgICB0aGlzLl9jYXJkTmFtZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fY2FyZC10ZXh0Jyk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fYnV0dG9uLWxpa2UnKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX2J1dHRvbi1kZWxldGUnKTtcblxuICAgIC8vY2FyZCAvLyBkZXN0cnVjdHVyaW5nIGFzc2lnbm1lbnQvL1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmROYW1lLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5zZXRMaWtlQ291bnRlcih0aGlzLl9saWtlcyk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cblxuIiwiY29uc3QgUE9QVVBfQ0xBU1MgPSAncG9wdXAnO1xuY29uc3QgQ0xPU0VfQlVUVE9OX0NMQVNTID0gJ3BvcHVwX19jbG9zZSc7XG5jb25zdCBQT1BVUF9TRUxFQ1RPUl9DTEFTUyA9ICdwb3B1cF9vcGVuJztcblxuZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKVxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKVxuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFBPUFVQX1NFTEVDVE9SX0NMQVNTKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShQT1BVUF9TRUxFQ1RPUl9DTEFTUyk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhQT1BVUF9DTEFTUykgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoQ0xPU0VfQlVUVE9OX0NMQVNTKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG4vLyoqKiBtb3VzZWRvd24gcmVwbGFjZWQgY2xpY2sgdG8gcHJldmVudCB0aGUgYnVnIGlmIHlvdSBjbGljayBpbnNpZGUgYSBwb3B1cCBhbmQgdGhlbiBtb3ZlIHlvdXIgbW91c2Ugb3V0c2lkZSBpdFxuLy8gYW5kIHJlbGVhc2UgdGhlIGJ1dHRvbiBhYm92ZSB0aGUgb3ZlcmxheSB0aGVuIHRoZSBwb3B1cCBjbG9zZXMgYnV0IGl04oCZcyBub3RcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdEZvcm0gKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3RvcilcblxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gPSBoYW5kbGVTdWJtaXRGb3JtXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpXG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JykgICAgICAgLy9bLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JyldXG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgdmFsdWVzID0ge31cblxuXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBpbnB1dC5pZFxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZVxuICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZVxuICAgIH0pXG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG4gICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoICdzdWJtaXQnLCAoZSkgPT4ge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKVxuICAgICAgICB9KVxuICAgICAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpe1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pXG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICAgIHN1cGVyLmNsb3NlKClcbiAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKVxuICB9XG5cbn1cblxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmxcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzXG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUnLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSkudGhlbiggcmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCkpXG4gICAgLy8gLmNhdGNoKGVyciA9PiB7XG4gICAgLy8gICBjb25zb2xlLmxvZygnQXBpIGhhcyBhbiBlcnJvciEhIScpXG4gICAgLy8gfSlcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMnLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSkudGhlbiggcmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCkpXG4gIH0gLy9uYW1lICAmIGxpbmsgaW4gdGhlIGJvZHkgY2hlY2sgbS5cblxuICBlZGl0UHJvZmlsZShuYW1lLCBhYm91dCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy91c2Vycy9tZScsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KVxuICAgIH0pLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCkpXG4gIH1cblxuICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMnLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pXG4gICAgfSkudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcbiAgfVxuXG4gIGFkZExpa2UoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvbGlrZXMvJyArIGlkLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSkudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcbiAgfVxuXG4gIHJlbW92ZUxpa2UoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvbGlrZXMvJyArIGlkLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSkudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcbiAgfVxuXG5cbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiOTM5OGE0ODMtNDg0ZS00ZWJkLWEzNzQtYjZiM2I5ODVlOWM0XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfVxufSk7IC8vIHRoaXMuX2Jhc2VVcmwgLy8gdGhpcy5faGVhZGVyc1xuIiwiXG5pbXBvcnQgXCIuLi9wYWdlL2luZGV4LmNzc1wiOyAvLyBtYWluIGJyaWRnZSB0byBjc3MgZmlsZXMgYWZ0ZXIgd2VicGFjayBidWlsZCBhbHdheXMgaW5zdGFsbCAxc3RcblxuaW1wb3J0IHsgc2V0dGluZ3MsIGVkaXRGb3JtLCBhZGRDYXJkRm9ybSwgZWRpdEJ1dHRvbiwgY2xvc2VCdXR0b24sIGlucHV0TmFtZSwgaW5wdXRQcm9mZXNzaW9uLFxuICBhZGRCdXR0b24sIGVsZW1lbnRzTGlzdCB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuXG5pbXBvcnQgeyBhcGksIEFwaSB9IGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcblxubGV0IHVzZXJJZFxuXG4vL2FwaS5nZXRVc2VySW5mbyAmIGFwaS5nZXRJbml0aWFsQ2FyZHMgY29tYmluZWQgd2l0aCBQcm9taXNlLlxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQgIC8vdXNlckRhdGEuX3VzZXJJZFxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsICB1c2VyRGF0YS5hYm91dClcblxuICAgIHNlY3Rpb24ucmVuZGVyZXJJdGVtcyhjYXJkcyk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmxvZylcblxuLy9mb3JtIHZhbGlkYXRvciBzZXR0aW5ncyBkb20gcmVmZXJlbmNlcy8vXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBzZXR0aW5ncyxcbiAgIGVkaXRGb3JtXG4gICk7XG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBzZXR0aW5ncyxcbiAgYWRkQ2FyZEZvcm1cbiAgKTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG5cbi8vYWRkY2FyZHN1Ym1pdFxuY29uc3QgaGFuZGxlQ2FyZFN1Ym1pdCA9IChkYXRhKSA9PiB7XG5cbiAgYXBpLmFkZENhcmQoZGF0YS5jYXJkVGl0bGUsIGRhdGEuY2FyZEltYWdlTGluaylcbiAgLnRoZW4ocmVzID0+IHtcbiAgICBjb25zb2xlLmxvZygncmVzID0+JywgcmVzKVxuICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICBuYW1lOiByZXMubmFtZSxcbiAgICAgIGxpbms6IHJlcy5saW5rLFxuICAgICAgbGlrZXM6IHJlcy5saWtlcyxcbiAgICAgIF9pZDogcmVzLl9pZCxcbiAgICB9O1xuICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUubG9nKVxuXG4gIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xufVxuLy9lZGl0cHJvZmlsZSBzdWJtaXRcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgYXBpLmVkaXRQcm9maWxlKGRhdGEubmFtZSwgZGF0YS5wcm9mZXNzaW9uKVxuICAudGhlbiggcmVzID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhLm5hbWUsIGRhdGEucHJvZmVzc2lvbilcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUubG9nKVxuICAuZmluYWxseSggKCkgPT4ge1xuICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKVxuICB9KVxufTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cC10ZW1wbGF0ZS1mb3JtJywgaGFuZGxlQ2FyZFN1Ym1pdClcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpIC8vb25seSBjYWxsIG9uY2UgLCBuZXZlciBpbiBpZiBsb29wIGV0Y1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJyNwb3B1cC10ZW1wbGF0ZScsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KVxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJyNwb3B1cC1pbWFnZScpXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNyZWF0ZUNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBpdGVtID0gbmV3IENhcmQgKFxuICAgIGRhdGEsXG4gICAgdXNlcklkLFxuICAgICcjY2FyZC10ZW1wbGF0ZScsXG4gIChuYW1lLCBsaW5rKSA9PiB7XG4gICAgaW1hZ2VQb3B1cC5vcGVuKG5hbWUsIGxpbmspXG4gICAgfSxcbiAgICAoKSA9PiB7XG4gICAgICBpZihpdGVtLmlzTGlrZWQoKSkge1xuICAgICAgICBhcGkucmVtb3ZlTGlrZShpdGVtLmdldElkKCkpXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgaXRlbS5zZXRMaWtlQ291bnRlcihyZXMubGlrZXMpXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcInlvdSBkb24ndCBsaWtlIGl0XCIpXG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGkuYWRkTGlrZShpdGVtLmdldElkKCkpXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgaXRlbS5zZXRMaWtlQ291bnRlcihyZXMubGlrZXMpXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcInlvdSBsaWtlIGl0IVwiKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgKTtcblxuIHJldHVybiBpdGVtLmdlbmVyYXRlQ2FyZCgpO1xufVxuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgcmVuZGVyZXI6IGNyZWF0ZUNhcmQsXG4gICAgfSxcbiAgICAnLmVsZW1lbnRzX19jYXJkcydcbiAgKVxuXG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcjogJy5wcm9maWxlX19oZWFkZXInLFxuICBwcm9maWxlUHJvZmVzc2lvblNlbGVjdG9yOiAnLnByb2ZpbGVfX3Byb2Zlc3Npb24nLFxufSlcblxuLy91c2VyaW5mbyBjbGFzc1xuY29uc3Qgb3BlblByb2ZpbGVQb3B1cCA9ICgpID0+IHtcbiAgY29uc3QgcHJvZmlsZUluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuXG4gIGlucHV0TmFtZS52YWx1ZSA9IHByb2ZpbGVJbmZvLm5hbWVcbiAgaW5wdXRQcm9mZXNzaW9uLnZhbHVlID0gcHJvZmlsZUluZm8ucHJvZmVzc2lvbjtcblxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTsgLy8yIGtlcmUgbWkgcmVzZXRsZW5kaSBiYWthbMSxbVxuICBlZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVCdXR0b24oKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKClcbn1cblxuLy9FdmVudCBoYW5kbGVyc1xuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Qcm9maWxlUG9wdXApO1xuXG5cblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KVxuXG5cblxuIiwiXG5pbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpXG4gICAgdGhpcy5fc3VidGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3N1YnRpdGxlJyk7XG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XG4gIH1cblxuXG4gIG9wZW4obmFtZSwgbGluaykge1xuXG4gICAgc3VwZXIub3BlbigpXG4gICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xuICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcbiAgICAgIHRoaXMuX3N1YnRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcblxuICB9XG5cbn1cbiIsIlxuZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lciApIHtcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKTtcbiAgfVxuXG5cblxuICByZW5kZXJlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xuICAgICAgICB0aGlzLmFkZEl0ZW0oZGF0YSlcbiAgICB9KVxuICB9O1xuXG4gIGFkZEl0ZW0oZGF0YSkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLl9yZW5kZXJlcihkYXRhKVxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpXG4gIH07XG5cblxufVxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3Ioe3Byb2ZpbGVOYW1lU2VsZWN0b3IsIHByb2ZpbGVQcm9mZXNzaW9uU2VsZWN0b3J9KVxuICB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWU9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWVTZWxlY3RvcilcbiAgICB0aGlzLl9wcm9maWxlUHJvZmVzc2lvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvcilcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgcHJvZmVzc2lvbjogdGhpcy5fcHJvZmlsZVByb2Zlc3Npb24udGV4dENvbnRlbnQsXG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgcHJvZmVzc2lvbikge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9wcm9maWxlUHJvZmVzc2lvbi50ZXh0Q29udGVudCA9IHByb2Zlc3Npb247XG4gIH1cblxuXG59XG4iXSwibmFtZXMiOlsicHJvZmlsZUluZm8iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcm9maWxlUG9wdXAiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9ybXMiLCJwcm9maWxlRm9ybSIsImVkaXRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dFByb2Zlc3Npb24iLCJwcmV2aWV3SW1hZ2UiLCJhZGRCdXR0b24iLCJzZXR0aW5ncyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZWRpdEZvcm0iLCJhZGRDYXJkRm9ybSIsImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dCIsImVycm9yTWVzc2FnZSIsInRoaXMiLCJfc2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwicmVtb3ZlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiX3RvZ2dsZUJ1dHRvbiIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImV2ZXJ5IiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaGFzVmFsaWRJbnB1dCIsImVuYWJsZUJ1dHRvbiIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJDYXJkIiwiZGF0YSIsInVzZXJJZCIsInRlbXBsYXRlQ2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUljb24iLCJfY2FyZEVsZW1lbnQiLCJfbGlrZUJ1dHRvbiIsIl9oYW5kbGVMaWtlSWNvbiIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlQ2FyZERlbGV0ZSIsIl9jYXJkSW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX25hbWUiLCJfbGluayIsIl9kYXRhIiwibmFtZSIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9pZCIsIl91c2VySWQiLCJfdGVtcGxhdGVDYXJkU2VsZWN0b3IiLCJnZXRJZCIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJzZXRMaWtlQ291bnRlciIsIm5ld0xpa2VzIiwibGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJpc0xpa2VkIiwiZmluZCIsInVzZXIiLCJnZW5lcmF0ZUNhcmQiLCJjbG9uZU5vZGUiLCJfY2FyZE5hbWUiLCJzcmMiLCJhbHQiLCJfYWRkRXZlbnRMaXN0ZW5lcnMiLCJQT1BVUF9TRUxFQ1RPUl9DTEFTUyIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXRGb3JtIiwic3VwZXIiLCJfaGFuZGxlU3VibWl0Rm9ybSIsIl9mb3JtIiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsInZhbHVlIiwiZSIsInNldElucHV0VmFsdWVzIiwicmVzZXQiLCJhcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsImdldEluaXRpYWxDYXJkcyIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImF1dGhvcml6YXRpb24iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNlY3Rpb24iLCJyZW5kZXJlckl0ZW1zIiwiY2F0Y2giLCJjb25zb2xlIiwibG9nIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkUG9wdXAiLCJjYXJkVGl0bGUiLCJjYXJkSW1hZ2VMaW5rIiwiY2FyZCIsImFkZEl0ZW0iLCJlZGl0UHJvZmlsZVBvcHVwIiwicHJvZmVzc2lvbiIsImZpbmFsbHkiLCJpbWFnZVBvcHVwIiwiX3N1YnRpdGxlIiwiX2ltYWdlIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsIml0ZW0iLCJwcm9maWxlTmFtZVNlbGVjdG9yIiwicHJvZmlsZVByb2Zlc3Npb25TZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlUHJvZmVzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=